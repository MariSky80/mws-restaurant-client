!function(){return function e(t,n,i){function r(a,c){if(!n[a]){if(!t[a]){var s="function"==typeof require&&require;if(!c&&s)return s(a,!0);if(o)return o(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var p=n[a]={exports:{}};t[a][0].call(p.exports,function(e){return r(t[a][1][e]||e)},p,p.exports,e,t,n,i)}return n[a].exports}for(var o="function"==typeof require&&require,a=0;a<i.length;a++)r(i[a]);return r}}()({1:[function(e,t,n){"use strict";!function(){function e(e){return new Promise(function(t,n){e.onsuccess=function(){t(e.result)},e.onerror=function(){n(e.error)}})}function n(t,n,i){var r,o=new Promise(function(o,a){e(r=t[n].apply(t,i)).then(o,a)});return o.request=r,o}function i(e,t,n){n.forEach(function(n){Object.defineProperty(e.prototype,n,{get:function(){return this[t][n]},set:function(e){this[t][n]=e}})})}function r(e,t,i,r){r.forEach(function(r){r in i.prototype&&(e.prototype[r]=function(){return n(this[t],r,arguments)})})}function o(e,t,n,i){i.forEach(function(i){i in n.prototype&&(e.prototype[i]=function(){return this[t][i].apply(this[t],arguments)})})}function a(e,t,i,r){r.forEach(function(r){r in i.prototype&&(e.prototype[r]=function(){return e=this[t],(i=n(e,r,arguments)).then(function(e){if(e)return new s(e,i.request)});var e,i})})}function c(e){this._index=e}function s(e,t){this._cursor=e,this._request=t}function u(e){this._store=e}function p(e){this._tx=e,this.complete=new Promise(function(t,n){e.oncomplete=function(){t()},e.onerror=function(){n(e.error)},e.onabort=function(){n(e.error)}})}function l(e,t,n){this._db=e,this.oldVersion=t,this.transaction=new p(n)}function f(e){this._db=e}i(c,"_index",["name","keyPath","multiEntry","unique"]),r(c,"_index",IDBIndex,["get","getKey","getAll","getAllKeys","count"]),a(c,"_index",IDBIndex,["openCursor","openKeyCursor"]),i(s,"_cursor",["direction","key","primaryKey","value"]),r(s,"_cursor",IDBCursor,["update","delete"]),["advance","continue","continuePrimaryKey"].forEach(function(t){t in IDBCursor.prototype&&(s.prototype[t]=function(){var n=this,i=arguments;return Promise.resolve().then(function(){return n._cursor[t].apply(n._cursor,i),e(n._request).then(function(e){if(e)return new s(e,n._request)})})})}),u.prototype.createIndex=function(){return new c(this._store.createIndex.apply(this._store,arguments))},u.prototype.index=function(){return new c(this._store.index.apply(this._store,arguments))},i(u,"_store",["name","keyPath","indexNames","autoIncrement"]),r(u,"_store",IDBObjectStore,["put","add","delete","clear","get","getAll","getKey","getAllKeys","count"]),a(u,"_store",IDBObjectStore,["openCursor","openKeyCursor"]),o(u,"_store",IDBObjectStore,["deleteIndex"]),p.prototype.objectStore=function(){return new u(this._tx.objectStore.apply(this._tx,arguments))},i(p,"_tx",["objectStoreNames","mode"]),o(p,"_tx",IDBTransaction,["abort"]),l.prototype.createObjectStore=function(){return new u(this._db.createObjectStore.apply(this._db,arguments))},i(l,"_db",["name","version","objectStoreNames"]),o(l,"_db",IDBDatabase,["deleteObjectStore","close"]),f.prototype.transaction=function(){return new p(this._db.transaction.apply(this._db,arguments))},i(f,"_db",["name","version","objectStoreNames"]),o(f,"_db",IDBDatabase,["close"]),["openCursor","openKeyCursor"].forEach(function(e){[u,c].forEach(function(t){t.prototype[e.replace("open","iterate")]=function(){var t,n=(t=arguments,Array.prototype.slice.call(t)),i=n[n.length-1],r=this._store||this._index,o=r[e].apply(r,n.slice(0,-1));o.onsuccess=function(){i(o.result)}}})}),[c,u].forEach(function(e){e.prototype.getAll||(e.prototype.getAll=function(e,t){var n=this,i=[];return new Promise(function(r){n.iterateCursor(e,function(e){e?(i.push(e.value),void 0===t||i.length!=t?e.continue():r(i)):r(i)})})})});var g={open:function(e,t,i){var r=n(indexedDB,"open",[e,t]),o=r.request;return o.onupgradeneeded=function(e){i&&i(new l(o.result,e.oldVersion,o.transaction))},r.then(function(e){return new f(e)})},delete:function(e){return n(indexedDB,"deleteDatabase",[e])}};void 0!==t?(t.exports=g,t.exports.default=t.exports):self.idb=g}()},{}],2:[function(e,t,n){const i="pending_restaurants",r="pending_reviews",o=e("idb").open("restaurant-db",2,function(e){switch(e.oldVersion){case 0:case 1:case 2:e.createObjectStore("restaurants",{keyPath:"id"}).createIndex("by-id","id",{unique:!0}),e.createObjectStore("reviews",{keyPath:"id"}).createIndex("by-restaurant-id","restaurant_id"),e.createObjectStore(i,{keyPath:"id"}).createIndex("by-id","id",{unique:!0}),e.createObjectStore(r,{keyPath:"id",autoIncrement:!0}).createIndex("by-id","id",{unique:!0})}});let a=["/","manifest.json","index.html","restaurant.html","css/main.css","css/detail.css","js/bundle_main.js","js/bundle_restaurant.js","sw.js","img/favicon/apple-icon-57x57.png","img/favicon/apple-icon-60x60.png","img/favicon/apple-icon-72x72.png","img/favicon/apple-icon-76x76.png","img/favicon/apple-icon-114x114.png","img/favicon/apple-icon-120x120.png","img/favicon/apple-icon-144x144.png","img/favicon/apple-icon-152x152.png","img/favicon/apple-icon-180x180.png","img/favicon/android-icon-192x192.png","img/favicon/favicon-32x32.png","img/favicon/favicon-96x96.png","img/favicon/favicon-16x16.png","img/favicon/ms-icon-144x144.png","img/favicon/ms-icon-70x70.png","img/favicon/ms-icon-150x150.png","img/favicon/ms-icon-310x310.png","img/favicon/android-icon-512x512.png","img/favicon/favicon.ico","img/1-380_small.jpg","img/1-512_medium.jpg","img/1-800_large.jpg","img/2-380_small.jpg","img/2-512_medium.jpg","img/2-800_large.jpg","img/3-380_small.jpg","img/3-512_medium.jpg","img/3-800_large.jpg","img/4-380_small.jpg","img/4-512_medium.jpg","img/4-800_large.jpg","img/5-380_small.jpg","img/5-512_medium.jpg","img/5-800_large.jpg","img/6-380_small.jpg","img/6-512_medium.jpg","img/6-800_large.jpg","img/7-380_small.jpg","img/7-512_medium.jpg","img/7-800_large.jpg","img/8-380_small.jpg","img/8-512_medium.jpg","img/8-800_large.jpg","img/9-380_small.jpg","img/9-512_medium.jpg","img/9-800_large.jpg","img/10-380_small.jpg","img/10-512_medium.jpg","img/10-800_large.jpg"];self.addEventListener("install",function(e){e.waitUntil(caches.open("mws-restaurant-stage-3").then(function(e){return e.addAll(a)}))}),self.addEventListener("activate",function(e){e.waitUntil(caches.keys().then(function(e){return Promise.all(e.filter(function(e){return e.startsWith("mws-")&&"mws-restaurant-stage-3"!=e}).map(function(e){return caches.delete(e)})).then(()=>{console.log("Service worker active")})}))}),self.addEventListener("fetch",function(e){e.respondWith(caches.match(e.request).then(function(t){return t||fetch(e.request)}))}),self.addEventListener("message",function(e){"skipWaiting"===e.data.action&&self.skipWaiting()}),self.addEventListener("sync",function(e){switch(e.tag){case"review":e.waitUntil(void o.then(e=>{if(e)return e.transaction(r).objectStore(r).getAll()}).then(e=>{const t=[];return e.forEach(function(e){let n={restaurant_id:e.restaurant_id,name:e.name,rating:e.rating,comments:e.comments,createdAt:e.createdAt,updatedAt:e.updatedAt};t.push(function(e){return fetch("http://localhost:1337/reviews",{method:"post",headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json"},body:JSON.stringify(e)}).then(e=>e.json()).then(e=>console.log(e))}(n))}),Promise.all(t)}).then(e=>{o.then(e=>{if(!e)return;const t=e.transaction(r,"readwrite");return t.objectStore(r).clear(),t.complete})}).catch(e=>{console.error(e)}));break;case"favorite":e.waitUntil(void o.then(e=>{if(e)return e.transaction(i).objectStore(i).getAll()}).then(e=>{const t=[];return e.forEach(function(e){t.push(function(e){return fetch(`http://localhost:1337/restaurants/${e.restaurant_id}/?is_favorite=${e.is_favorite}`,{method:"put",headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json"},body:JSON.stringify(e)}).then(e=>e.json()).then(e=>console.log(e))}(e))}),Promise.all(t)}).then(e=>{o.then(e=>{if(!e)return;const t=e.transaction(i,"readwrite");return t.objectStore(i).clear(),t.complete})}).catch(e=>{console.error(e)}))}})},{idb:1}]},{},[2]);