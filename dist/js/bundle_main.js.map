{"version":3,"sources":["node_modules/browser-pack/_prelude.js","node_modules/idb/lib/idb.js","resources/js/dbhelper.js","resources/js/main.js"],"names":[],"mappings":"AAAA;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;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","file":"bundle_main.js","sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()","'use strict';\n\n(function() {\n  function toArray(arr) {\n    return Array.prototype.slice.call(arr);\n  }\n\n  function promisifyRequest(request) {\n    return new Promise(function(resolve, reject) {\n      request.onsuccess = function() {\n        resolve(request.result);\n      };\n\n      request.onerror = function() {\n        reject(request.error);\n      };\n    });\n  }\n\n  function promisifyRequestCall(obj, method, args) {\n    var request;\n    var p = new Promise(function(resolve, reject) {\n      request = obj[method].apply(obj, args);\n      promisifyRequest(request).then(resolve, reject);\n    });\n\n    p.request = request;\n    return p;\n  }\n\n  function promisifyCursorRequestCall(obj, method, args) {\n    var p = promisifyRequestCall(obj, method, args);\n    return p.then(function(value) {\n      if (!value) return;\n      return new Cursor(value, p.request);\n    });\n  }\n\n  function proxyProperties(ProxyClass, targetProp, properties) {\n    properties.forEach(function(prop) {\n      Object.defineProperty(ProxyClass.prototype, prop, {\n        get: function() {\n          return this[targetProp][prop];\n        },\n        set: function(val) {\n          this[targetProp][prop] = val;\n        }\n      });\n    });\n  }\n\n  function proxyRequestMethods(ProxyClass, targetProp, Constructor, properties) {\n    properties.forEach(function(prop) {\n      if (!(prop in Constructor.prototype)) return;\n      ProxyClass.prototype[prop] = function() {\n        return promisifyRequestCall(this[targetProp], prop, arguments);\n      };\n    });\n  }\n\n  function proxyMethods(ProxyClass, targetProp, Constructor, properties) {\n    properties.forEach(function(prop) {\n      if (!(prop in Constructor.prototype)) return;\n      ProxyClass.prototype[prop] = function() {\n        return this[targetProp][prop].apply(this[targetProp], arguments);\n      };\n    });\n  }\n\n  function proxyCursorRequestMethods(ProxyClass, targetProp, Constructor, properties) {\n    properties.forEach(function(prop) {\n      if (!(prop in Constructor.prototype)) return;\n      ProxyClass.prototype[prop] = function() {\n        return promisifyCursorRequestCall(this[targetProp], prop, arguments);\n      };\n    });\n  }\n\n  function Index(index) {\n    this._index = index;\n  }\n\n  proxyProperties(Index, '_index', [\n    'name',\n    'keyPath',\n    'multiEntry',\n    'unique'\n  ]);\n\n  proxyRequestMethods(Index, '_index', IDBIndex, [\n    'get',\n    'getKey',\n    'getAll',\n    'getAllKeys',\n    'count'\n  ]);\n\n  proxyCursorRequestMethods(Index, '_index', IDBIndex, [\n    'openCursor',\n    'openKeyCursor'\n  ]);\n\n  function Cursor(cursor, request) {\n    this._cursor = cursor;\n    this._request = request;\n  }\n\n  proxyProperties(Cursor, '_cursor', [\n    'direction',\n    'key',\n    'primaryKey',\n    'value'\n  ]);\n\n  proxyRequestMethods(Cursor, '_cursor', IDBCursor, [\n    'update',\n    'delete'\n  ]);\n\n  // proxy 'next' methods\n  ['advance', 'continue', 'continuePrimaryKey'].forEach(function(methodName) {\n    if (!(methodName in IDBCursor.prototype)) return;\n    Cursor.prototype[methodName] = function() {\n      var cursor = this;\n      var args = arguments;\n      return Promise.resolve().then(function() {\n        cursor._cursor[methodName].apply(cursor._cursor, args);\n        return promisifyRequest(cursor._request).then(function(value) {\n          if (!value) return;\n          return new Cursor(value, cursor._request);\n        });\n      });\n    };\n  });\n\n  function ObjectStore(store) {\n    this._store = store;\n  }\n\n  ObjectStore.prototype.createIndex = function() {\n    return new Index(this._store.createIndex.apply(this._store, arguments));\n  };\n\n  ObjectStore.prototype.index = function() {\n    return new Index(this._store.index.apply(this._store, arguments));\n  };\n\n  proxyProperties(ObjectStore, '_store', [\n    'name',\n    'keyPath',\n    'indexNames',\n    'autoIncrement'\n  ]);\n\n  proxyRequestMethods(ObjectStore, '_store', IDBObjectStore, [\n    'put',\n    'add',\n    'delete',\n    'clear',\n    'get',\n    'getAll',\n    'getKey',\n    'getAllKeys',\n    'count'\n  ]);\n\n  proxyCursorRequestMethods(ObjectStore, '_store', IDBObjectStore, [\n    'openCursor',\n    'openKeyCursor'\n  ]);\n\n  proxyMethods(ObjectStore, '_store', IDBObjectStore, [\n    'deleteIndex'\n  ]);\n\n  function Transaction(idbTransaction) {\n    this._tx = idbTransaction;\n    this.complete = new Promise(function(resolve, reject) {\n      idbTransaction.oncomplete = function() {\n        resolve();\n      };\n      idbTransaction.onerror = function() {\n        reject(idbTransaction.error);\n      };\n      idbTransaction.onabort = function() {\n        reject(idbTransaction.error);\n      };\n    });\n  }\n\n  Transaction.prototype.objectStore = function() {\n    return new ObjectStore(this._tx.objectStore.apply(this._tx, arguments));\n  };\n\n  proxyProperties(Transaction, '_tx', [\n    'objectStoreNames',\n    'mode'\n  ]);\n\n  proxyMethods(Transaction, '_tx', IDBTransaction, [\n    'abort'\n  ]);\n\n  function UpgradeDB(db, oldVersion, transaction) {\n    this._db = db;\n    this.oldVersion = oldVersion;\n    this.transaction = new Transaction(transaction);\n  }\n\n  UpgradeDB.prototype.createObjectStore = function() {\n    return new ObjectStore(this._db.createObjectStore.apply(this._db, arguments));\n  };\n\n  proxyProperties(UpgradeDB, '_db', [\n    'name',\n    'version',\n    'objectStoreNames'\n  ]);\n\n  proxyMethods(UpgradeDB, '_db', IDBDatabase, [\n    'deleteObjectStore',\n    'close'\n  ]);\n\n  function DB(db) {\n    this._db = db;\n  }\n\n  DB.prototype.transaction = function() {\n    return new Transaction(this._db.transaction.apply(this._db, arguments));\n  };\n\n  proxyProperties(DB, '_db', [\n    'name',\n    'version',\n    'objectStoreNames'\n  ]);\n\n  proxyMethods(DB, '_db', IDBDatabase, [\n    'close'\n  ]);\n\n  // Add cursor iterators\n  // TODO: remove this once browsers do the right thing with promises\n  ['openCursor', 'openKeyCursor'].forEach(function(funcName) {\n    [ObjectStore, Index].forEach(function(Constructor) {\n      Constructor.prototype[funcName.replace('open', 'iterate')] = function() {\n        var args = toArray(arguments);\n        var callback = args[args.length - 1];\n        var nativeObject = this._store || this._index;\n        var request = nativeObject[funcName].apply(nativeObject, args.slice(0, -1));\n        request.onsuccess = function() {\n          callback(request.result);\n        };\n      };\n    });\n  });\n\n  // polyfill getAll\n  [Index, ObjectStore].forEach(function(Constructor) {\n    if (Constructor.prototype.getAll) return;\n    Constructor.prototype.getAll = function(query, count) {\n      var instance = this;\n      var items = [];\n\n      return new Promise(function(resolve) {\n        instance.iterateCursor(query, function(cursor) {\n          if (!cursor) {\n            resolve(items);\n            return;\n          }\n          items.push(cursor.value);\n\n          if (count !== undefined && items.length == count) {\n            resolve(items);\n            return;\n          }\n          cursor.continue();\n        });\n      });\n    };\n  });\n\n  var exp = {\n    open: function(name, version, upgradeCallback) {\n      var p = promisifyRequestCall(indexedDB, 'open', [name, version]);\n      var request = p.request;\n\n      request.onupgradeneeded = function(event) {\n        if (upgradeCallback) {\n          upgradeCallback(new UpgradeDB(request.result, event.oldVersion, request.transaction));\n        }\n      };\n\n      return p.then(function(db) {\n        return new DB(db);\n      });\n    },\n    delete: function(name) {\n      return promisifyRequestCall(indexedDB, 'deleteDatabase', [name]);\n    }\n  };\n\n  if (typeof module !== 'undefined') {\n    module.exports = exp;\n    module.exports.default = module.exports;\n  }\n  else {\n    self.idb = exp;\n  }\n}());\n","const idb = require('idb');\r\nconst IDB_DB = 'restaurant-db';\r\nconst IDB_RESTAURANTS = 'restaurants';\r\nconst IDB_REVIEWS = 'reviews';\r\n\r\n /**\r\n  * @description  Common database helper functions.\r\n  * @constructor\r\n  */\r\nclass DBHelper {\r\n /**\r\n  * @description  Database URL. Change this to restaurants.json file location on your server.\r\n  * @constructor\r\n  */\r\n  static get RESTAURANTS_URL() {\r\n    const port = 1337 // Change this to your server port\r\n    return `http://localhost:${port}/restaurants`;\r\n  }\r\n\r\n  /**\r\n   * @description  Database URL. Change this to restaurants.json file location on your server.\r\n   * @constructor\r\n   */\r\n   static get REVIEWS_URL() {\r\n     const port = 1337 // Change this to your server port\r\n     return `http://localhost:${port}/reviews`;\r\n   }\r\n\r\n\r\n  /**\r\n   * @description  Open database.\r\n   * @constructor\r\n   */\r\n  static openIndexedDB() {\r\n    // If the browser doesn't support service worker,\r\n    // we don't care about having a database\r\n    if (!navigator.serviceWorker) {\r\n      return Promise.resolve();\r\n    }\r\n\r\n    this.dbPromise = idb.open(IDB_DB, 1, function (upgradeDb) {\r\n      switch (upgradeDb.oldVersion) {\r\n        case 0:\r\n        case 1:\r\n          const storeRestaurant = upgradeDb.createObjectStore(IDB_RESTAURANTS, {\r\n            keyPath: 'id'\r\n          });\r\n          storeRestaurant.createIndex('by-id', 'id', { unique: true });\r\n\r\n          const storeReviews = upgradeDb.createObjectStore(IDB_REVIEWS, {\r\n            keyPath: 'id'\r\n          });\r\n          storeReviews.createIndex('by-id', \"id\", { unique: true });\r\n          storeReviews.createIndex('by-restaurant-id', 'restaurant_id');\r\n      }\r\n    });\r\n  }\r\n\r\n\r\n  /**\r\n   * @description  Save data restaurant.\r\n   * @constructor\r\n   * @param {object} Object list - Object like restaurant, reveiw, ...\r\n   */\r\n  static storeIndexedDB(table, objects) {\r\n    this.dbPromise.then(function (db) {\r\n      if(!db) return;\r\n\r\n      let tx = db.transaction(table, 'readwrite');\r\n      const store = tx.objectStore(table);\r\n      if (Array.isArray(objects)) {\r\n        objects.forEach(function(object){\r\n          store.put(object);\r\n        });\r\n      } else {\r\n        store.put(objects);\r\n      }\r\n    });\r\n  }\r\n\r\n\r\n  /**\r\n   * @description  Get a collection of objects from indexedDB.\r\n   * @constructor\r\n   */\r\n  static getStoredObjects(table) {\r\n    return this.dbPromise.then(function(db) {\r\n      if(!db) return;\r\n      const store = db.transaction(table).objectStore(table);\r\n      return store.getAll();\r\n    })\r\n  }\r\n\r\n\r\n  /**\r\n   * @description  Get object from indexedDB by index\r\n   * @constructor {int} id - Restaurant id\r\n   */\r\n  static getStoredObjectById(table, idx, id) {\r\n    return this.dbPromise.then(function(db) {\r\n      if(!db) return;\r\n\r\n      const store = db.transaction(table).objectStore(table);\r\n      const indexId = store.index(idx);\r\n      return indexId.getAll(id);\r\n    });\r\n  }\r\n\r\n\r\n /**\r\n  * @description  Fetch all restaurants.\r\n  * @constructor\r\n  * @param {function} callback - Callback function.\r\n  */\r\n  static fetchRestaurants(callback) {\r\n    fetch(DBHelper.RESTAURANTS_URL)\r\n      .then(response => response.json())\r\n      .then(restaurants => {\r\n        DBHelper.storeIndexedDB(IDB_RESTAURANTS, restaurants);\r\n        callback(null, restaurants);\r\n      })\r\n      .catch(error => {\r\n        DBHelper.getStoredObjects(IDB_RESTAURANTS)\r\n        .then((storedRestaurants) => {\r\n          callback(null, storedRestaurants);\r\n        }).catch(error => {\r\n          callback(error, null);\r\n        })\r\n      });\r\n  }\r\n\r\n\r\n /**\r\n  * @description  Fetch a restaurant by its ID.\r\n  * @constructor\r\n  * @param {int} id - Restaurant identifier.\r\n  * @param {function} callback - Callback function.\r\n  */\r\n  static fetchRestaurantById(id, callback) {\r\n    fetch(`${DBHelper.RESTAURANTS_URL}/${id}`)\r\n      .then(response => response.json())\r\n      .then(restaurant => {\r\n        DBHelper.storeIndexedDB(IDB_RESTAURANTS, restaurant);\r\n        callback(null, restaurant);\r\n      })\r\n      .catch(error => {\r\n        DBHelper.getStoredObjectById(IDB_RESTAURANTS, 'by-id' ,id)\r\n        .then((storedRestaurant) => {\r\n          callback(null, storedRestaurant);\r\n        }).catch(error => {\r\n          callback(error, null);\r\n        })\r\n      });\r\n  }\r\n\r\n\r\n /**\r\n  * @description  Fetch restaurants by a cuisine type with proper error handling.\r\n  * @constructor\r\n  * @param {string} cuisine - Neighborhood selected.\r\n  * @param {function} callback - Callback function.\r\n  */\r\n  static fetchRestaurantByCuisine(cuisine, callback) {\r\n    // Fetch all restaurants  with proper error handling\r\n    DBHelper.fetchRestaurants((error, restaurants) => {\r\n      if (error) {\r\n        callback(error, null);\r\n      } else {\r\n        // Filter restaurants to have only given cuisine type\r\n        const results = restaurants.filter(r => r.cuisine_type == cuisine);\r\n        callback(null, results);\r\n      }\r\n    });\r\n  }\r\n\r\n\r\n /**\r\n  * @description  Fetch restaurants by a neighborhood with proper error handling.\r\n  * @constructor\r\n  * @param {string} neighborhood - Neighborhood selected.\r\n  * @param {function} callback - Callback function.\r\n  */\r\n  static fetchRestaurantByNeighborhood(neighborhood, callback) {\r\n    // Fetch all restaurants\r\n    DBHelper.fetchRestaurants((error, restaurants) => {\r\n      if (error) {\r\n        callback(error, null);\r\n      } else {\r\n        // Filter restaurants to have only given neighborhood\r\n        const results = restaurants.filter(r => r.neighborhood == neighborhood);\r\n        callback(null, results);\r\n      }\r\n    });\r\n  }\r\n\r\n\r\n /**\r\n  * @description  Fetch restaurants by a cuisine and a neighborhood with proper error handling.\r\n  * @constructor\r\n  * @param {string} cuisine - Cuisine selected.\r\n  * @param {string} neighborhood - Neighborhood selected.\r\n  * @param {function} callback - Callback function.\r\n  */\r\n  static fetchRestaurantByCuisineAndNeighborhood(cuisine, neighborhood, callback) {\r\n    // Fetch all restaurants\r\n    DBHelper.fetchRestaurants((error, restaurants) => {\r\n      if (error) {\r\n        callback(error, null);\r\n      } else {\r\n        let results = restaurants;\r\n        if (cuisine != 'all') { // filter by cuisine\r\n          results = results.filter(r => r.cuisine_type == cuisine);\r\n        }\r\n        if (neighborhood != 'all') { // filter by neighborhood\r\n          results = results.filter(r => r.neighborhood == neighborhood);\r\n        }\r\n        callback(null, results);\r\n      }\r\n    });\r\n  }\r\n\r\n\r\n /**\r\n  * @description  Fetch all neighborhoods with proper error handling.\r\n  * @constructor\r\n  * @param {function} callback - Callback function.\r\n  */\r\n  static fetchNeighborhoods(callback) {\r\n    // Fetch all restaurants\r\n    DBHelper.fetchRestaurants((error, restaurants) => {\r\n      if (error) {\r\n        callback(error, null);\r\n      } else {\r\n        // Get all neighborhoods from all restaurants\r\n        const neighborhoods = restaurants.map((v, i) => restaurants[i].neighborhood)\r\n        // Remove duplicates from neighborhoods\r\n        const uniqueNeighborhoods = neighborhoods.filter((v, i) => neighborhoods.indexOf(v) == i)\r\n        callback(null, uniqueNeighborhoods);\r\n      }\r\n    });\r\n  }\r\n\r\n\r\n /**\r\n  * @description  Fetch all cuisines with proper error handling.\r\n  * @constructor\r\n  * @param {function} callback - Callback function.\r\n  */\r\n  static fetchCuisines(callback) {\r\n    // Fetch all restaurants\r\n    DBHelper.fetchRestaurants((error, restaurants) => {\r\n      if (error) {\r\n        callback(error, null);\r\n      } else {\r\n        // Get all cuisines from all restaurants\r\n        const cuisines = restaurants.map((v, i) => restaurants[i].cuisine_type)\r\n        // Remove duplicates from cuisines\r\n        const uniqueCuisines = cuisines.filter((v, i) => cuisines.indexOf(v) == i)\r\n        callback(null, uniqueCuisines);\r\n      }\r\n    });\r\n  }\r\n\r\n\r\n\r\n  /**\r\n  * @description  Fetch all reviews.\r\n  * @constructor\r\n  * @param {function} callback - Callback function.\r\n  */\r\n  static fetchReviews(callback) {\r\n    fetch(DBHelper.REVIEWS_URL)\r\n      .then(response => response.json())\r\n      .then(reviews => {\r\n        DBHelper.storeIndexedDB(IDB_REVIEWS, reviews);\r\n        callback(null, reviews);\r\n      })\r\n      .catch(error => {\r\n        DBHelper.getStoredObjects(IDB_REVIEWS)\r\n        .then((storedReviews) => {\r\n          callback(null, storedReviews);\r\n        }).catch(error => {\r\n          callback(error, null);\r\n        })\r\n      });\r\n  }\r\n\r\n\r\n  /**\r\n   * @description  Fetch a review by its ID.\r\n   * @constructor\r\n   * @param {int} id - Reviews identifier.\r\n   * @param {function} callback - Callback function.\r\n   */\r\n   static fetchReviewsById(id, callback) {\r\n     fetch(`${DBHelper.REVIEWS_URL}/${id}`)\r\n       .then(response => response.json())\r\n       .then(review => {\r\n         DBHelper.storeIndexedDB(IDB_REVIEWS, review);\r\n         callback(null, review)\r\n       })\r\n       .catch(error => {\r\n         DBHelper.getStoredObjectById(IDB_REVIEWS, 'by-id', id)\r\n         .then((storedReview) => {\r\n           callback(null, storedReview);\r\n         }).catch(error => {\r\n           callback(error, null);\r\n         })\r\n       });\r\n   }\r\n\r\n\r\n /**\r\n  * @description  Fetch all restaurant reviews by restaurant ID.\r\n  * @constructor\r\n  * @param {int} id - Restaurant identifier.\r\n  * @param {function} callback - Callback function.\r\n  */\r\n  static fetchReviewsByRestId(id, callback) {\r\n    fetch(`${DBHelper.REVIEWS_URL}/?restaurant_id=${id}`)\r\n      .then(response => response.json())\r\n      .then(reviews => {\r\n        DBHelper.storeIndexedDB(IDB_REVIEWS, reviews);\r\n        callback(null, reviews)\r\n      })\r\n      .catch(error => {\r\n        DBHelper.getStoredObjectById(IDB_REVIEWS, 'by-restaurant-id', id)\r\n        .then((storedReviews) => {\r\n          callback(null, storedReviews);\r\n        }).catch(error => {\r\n          callback(error, null);\r\n        })\r\n      });\r\n  }\r\n\r\n\r\n  /**\r\n   * @description  Send review to server and stores it at database.\r\n   * @constructor\r\n   * @param {object} review - Reviwe object.\r\n   * @param {function} callback - Callback function.\r\n   */\r\n  static postReview(review, callback) {\r\n    fetch(DBHelper.REVIEWS_URL,\r\n      {\r\n        method:'post',\r\n        body:review\r\n      })\r\n      .then(response => response.json())\r\n      .then(review => {\r\n        DBHelper.storeIndexedDB(IDB_REVIEWS, review);\r\n        callback(null, review);\r\n      })\r\n      .catch(error => {\r\n        callback(error, null);\r\n      });\r\n  }\r\n\r\n\r\n  /**\r\n   * @description  Send request favorite/unfavorite to server and changes at database.\r\n   * @constructor\r\n   * @param {int} id - Restaurant identifier.\r\n   * @param {boolean} favorite - True to mark as favorite, otherwise false.\r\n   * @param {function} callback - Callback function.\r\n   */\r\n  static putFavorite(id, favorite, callback) {\r\n    fetch(`${DBHelper.RESTAURANTS_URL}/${id}/?is_favorite=${favorite}`,\r\n      {\r\n        method:'put',\r\n        body:favorite\r\n      })\r\n      .then(response => response.json())\r\n      .then(favorite => {\r\n        DBHelper.storeIndexedDB(IDB_RESTAURANTS, favorite);        \r\n        callback(null, favorite);\r\n      })\r\n      .catch(error => {\r\n        callback(error, null);\r\n      });\r\n  }\r\n\r\n\r\n  /**\r\n   * @description  Send review to server and stores it at database.\r\n   * @constructor\r\n   * @param {object} review - Reviwe object.\r\n   * @param {function} callback - Callback function.\r\n   */\r\n  static postReview(review, callback) {\r\n    fetch(DBHelper.REVIEWS_URL,\r\n      {\r\n        method:'post',\r\n        body:review\r\n      })\r\n      .then(response => response.json())\r\n      .then(response => {\r\n        callback(null, response);\r\n      })\r\n      .catch(error => {\r\n        callback(error, null);\r\n      });\r\n  }\r\n\r\n\r\n /**\r\n  * @description  Restaurant page URL.\r\n  * @constructor\r\n  * @param {object} restaurant - Restaurant information.\r\n  */\r\n  static urlForRestaurant(restaurant) {\r\n    return (`./restaurant.html?id=${restaurant.id}`);\r\n  }\r\n\r\n\r\n /**\r\n  * @description Restaurant image URL.\r\n  * @constructor\r\n  * @param {object} restaurant - Restaurant information.\r\n  */\r\n  static imageUrlForRestaurant(restaurant) {\r\n    let photograph = ('photograph' in restaurant) ? restaurant.photograph : restaurant.id;\r\n    return (`/dist/img/${photograph}`);\r\n  }\r\n\r\n\r\n /**\r\n  * @description Map marker for a restaurant.\r\n  * @constructor\r\n  * @param {object} restaurant - Restaurant coords and name.\r\n  * @param {object} map - Google map object.\r\n  */\r\n  static mapMarkerForRestaurant(restaurant, map) {\r\n    const marker = new google.maps.Marker({\r\n      position: restaurant.latlng,\r\n      title: restaurant.name,\r\n      url: DBHelper.urlForRestaurant(restaurant),\r\n      map: map,\r\n      animation: google.maps.Animation.DROP}\r\n    );\r\n    return marker;\r\n  }\r\n\r\n\r\n /**\r\n  * @description Register ServiceWorker.\r\n  * @constructor\r\n  */\r\n  static registerServiceWorker() {\r\n    if ('serviceWorker' in navigator) {\r\n      navigator.serviceWorker.register('sw.js')\r\n        .then((reg) => {\r\n          console.log(`Service Worker registration successful. Its scope is ${reg.scope} `);\r\n        }).catch((error) => {\r\n          console.log(`Service Worker registration error: ${error}`);\r\n        });\r\n    }\r\n  }\r\n}\r\nmodule.exports = DBHelper;\r\n","const DBHelper = require('./dbhelper');\r\nlet restaurants,\r\n  neighborhoods,\r\n  cuisines;\r\nlet map;\r\nlet markers = [];\r\nlet staticMap = false;\r\nlet is_favorite;\r\n\r\n/**\r\n  * @description Call functions when DOM content is loaded\r\n  * @constructor\r\n  * @param {string} DOMContentLoaded - String detected.\r\n  * @param {event} event - Event called\r\n  */\r\ndocument.addEventListener('DOMContentLoaded', (event) => {\r\n  DBHelper.registerServiceWorker();\r\n  DBHelper.openIndexedDB();\r\n  fetchNeighborhoods();\r\n  fetchCuisines();\r\n});\r\n\r\n\r\n/**\r\n  * @description Call functions when window is resized\r\n  * @constructor\r\n  * @param {string} resize - String detected.\r\n  * @param {event} event - Event called\r\n  */\r\nwindow.addEventListener('resize', (event) =>{\r\n  initMap();\r\n});\r\n\r\n\r\n/**\r\n * @description  Fetch all neighborhoods and set their HTML.\r\n * @constructor\r\n * @param {object} error - error object.\r\n * @param {object} neighborhoods - neighborhood list.\r\n */\r\nfetchNeighborhoods = () => {\r\n  DBHelper.fetchNeighborhoods((error, neighborhoods) => {\r\n    if (error) { // Got an error\r\n      console.error(error);\r\n    } else {\r\n      self.neighborhoods = neighborhoods;\r\n      fillNeighborhoodsHTML();\r\n    }\r\n  });\r\n}\r\n\r\n\r\n/**\r\n* @description  Set neighborhoods HTML.\r\n* @constructor\r\n* @param {object} neighborhoods - neighborhood list.\r\n*/\r\nfillNeighborhoodsHTML = (neighborhoods = self.neighborhoods) => {\r\n  const select = document.getElementById('neighborhoods-select');\r\n  neighborhoods.forEach(neighborhood => {\r\n    const option = document.createElement('option');\r\n    option.innerHTML = neighborhood;\r\n    option.value = neighborhood;\r\n    select.append(option);\r\n  });\r\n}\r\n\r\n\r\n/**\r\n* @description  fetch all cuisines and set their HTML.\r\n* @constructor\r\n* @param {object} error - error object.\r\n* @param {object} cuisines - cuisines list.\r\n*/\r\nfetchCuisines = () => {\r\n  DBHelper.fetchCuisines((error, cuisines) => {\r\n    if (error) { // Got an error!\r\n      console.error(error);\r\n    } else {\r\n      self.cuisines = cuisines;\r\n      fillCuisinesHTML();\r\n    }\r\n  });\r\n}\r\n\r\n\r\n/**\r\n* @description  Set cuisines HTML.\r\n* @constructor\r\n* @param {object} cuisines - cuisines list.\r\n*/\r\nfillCuisinesHTML = (cuisines = self.cuisines) => {\r\n  const select = document.getElementById('cuisines-select');\r\n\r\n  cuisines.forEach(cuisine => {\r\n    const option = document.createElement('option');\r\n    option.innerHTML = cuisine;\r\n    option.value = cuisine;\r\n    select.append(option);\r\n  });\r\n}\r\n\r\n\r\n/**\r\n* @description  Update page and map for current restaurants.\r\n* @constructor\r\n*/\r\nupdateRestaurants = () => {\r\n  const cSelect = document.getElementById('cuisines-select');\r\n  const nSelect = document.getElementById('neighborhoods-select');\r\n\r\n  const cIndex = cSelect.selectedIndex;\r\n  const nIndex = nSelect.selectedIndex;\r\n\r\n  const cuisine = cSelect[cIndex].value;\r\n  const neighborhood = nSelect[nIndex].value;\r\n\r\n  DBHelper.fetchRestaurantByCuisineAndNeighborhood(cuisine, neighborhood, (error, restaurants) => {\r\n    if (error) { // Got an error!\r\n      console.error(error);\r\n    } else {\r\n      resetRestaurants(restaurants);\r\n      fillRestaurantsHTML();\r\n    }\r\n  })\r\n}\r\n\r\n\r\n/**\r\n* @description  Clear current restaurants, their HTML and remove their map markers.\r\n* @constructor\r\n* @param {object} restaurants - restaurants list.\r\n*/\r\nresetRestaurants = (restaurants) => {\r\n  // Remove all restaurants\r\n  self.restaurants = [];\r\n  const ul = document.getElementById('restaurants-list');\r\n  ul.innerHTML = '';\r\n\r\n  // Remove all map markers\r\n  if(self.markers !== undefined) {\r\n    self.markers.forEach(m => m.setMap(null));\r\n  }\r\n  self.markers = [];\r\n  self.restaurants = restaurants;\r\n\r\n}\r\n\r\n\r\n/**\r\n* @description Create all restaurants HTML and add them to the webpage.\r\n* @constructor\r\n* @param {object} restaurants - restaurants created.\r\n*/\r\nfillRestaurantsHTML = (restaurants = self.restaurants) => {\r\n  const ul = document.getElementById('restaurants-list');\r\n  restaurants.forEach(restaurant => {\r\n    ul.append(createRestaurantHTML(restaurant));\r\n  });\r\n  addMarkersToMap();\r\n}\r\n\r\n\r\n/**\r\n* @description Create restaurant HTML.\r\n* @constructor\r\n* @param {object} restaurant - restaurants object.\r\n*/\r\ncreateRestaurantHTML = (restaurant) => {\r\n  const li = document.createElement('li');\r\n\r\n  const img = DBHelper.imageUrlForRestaurant(restaurant);\r\n  const picture = document.createElement('picture');\r\n  picture.className = 'restaurant-img';\r\n  picture.setAttribute('aria-labelledby', `picture_${restaurant.id}`);\r\n  picture.setAttribute('role', 'img');\r\n\r\n  const sourceSmall = document.createElement('source');\r\n  sourceSmall.setAttribute('media', '(max-width:480px)');\r\n  sourceSmall.setAttribute('srcset', `${img}-380_small.jpg`);\r\n  picture.append(sourceSmall);\r\n\r\n  const sourceMedium = document.createElement('source');\r\n  sourceMedium.setAttribute('media', '(min-width: 480px) and (max-width: 960px)');\r\n  sourceMedium.setAttribute('srcset', `${img}-512_medium.jpg`);\r\n  picture.append(sourceMedium);\r\n\r\n  const sourceLarge = document.createElement('source');\r\n  sourceLarge.setAttribute('media', '(min-width:961px)');\r\n  sourceLarge.setAttribute('srcset', `${img}-800_large.jpg`);\r\n  picture.append(sourceLarge);\r\n\r\n  const image = document.createElement('img');\r\n  image.id = `picture_${restaurant.id}`;\r\n  image.className = 'restaurant-img';\r\n  image.alt = `Picture of ${restaurant.name} restaurant`;\r\n  image.src = `${img}-380_small.jpg`;\r\n\r\n  picture.append(image);\r\n\r\n  li.append(picture);\r\n\r\n\r\n  const name = document.createElement('h2');\r\n  name.innerHTML = restaurant.name;\r\n  li.append(name);\r\n\r\n  const neighborhood = document.createElement('p');\r\n  neighborhood.innerHTML = restaurant.neighborhood;\r\n  li.append(neighborhood);\r\n\r\n  const favorite = document.createElement('div');\r\n  favorite.className = 'fav';\r\n  const link = document.createElement('a');\r\n  link.className = 'favorite';\r\n  link.setAttribute('role', 'button');\r\n  link.setAttribute('tabindex', '0');\r\n  eventListenerFavorite(link, restaurant.id);\r\n\r\n  const svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');\r\n  svg.setAttribute('class','svg-fav');\r\n  svg.setAttribute('viewBox','0 0 576 512');\r\n  svg.setAttribute('aria-labelledby', `title-${restaurant.id} description-${restaurant.id}`);\r\n\r\n  const title = document.createElementNS('http://www.w3.org/2000/svg', \"title\");\r\n  title.setAttribute('id', `title-${restaurant.id}`);\r\n\r\n  const desc = document.createElementNS('http://www.w3.org/2000/svg', \"desc\");\r\n  desc.setAttribute('id', `description-${restaurant.id}`);\r\n  desc.innerHTML = 'Favorite image';\r\n\r\n  const path = document.createElementNS('http://www.w3.org/2000/svg', 'path');\r\n  path.setAttribute('class','path-fav');\r\n  path.setAttribute('role','presentation');\r\n\r\n  self.is_favorite = (restaurant.is_favorite == 'true') ? true : false;\r\n  if( self.is_favorite ) {\r\n    link.title = 'Remove favorite';\r\n    link.setAttribute('aria-label', 'Remove favorite');\r\n    link.dataset.favorite = 'remove';\r\n    title.innerHTML = 'Remove favorite';\r\n    path.setAttribute(\"d\",\"M259.3 17.8L194 150.2 47.9 171.5c-26.2 3.8-36.7 36.1-17.7 54.6l105.7 103-25 145.5c-4.5 26.3 23.2 46 46.4 33.7L288 439.6l130.7 68.7c23.2 12.2 50.9-7.4 46.4-33.7l-25-145.5 105.7-103c19-18.5 8.5-50.8-17.7-54.6L382 150.2 316.7 17.8c-11.7-23.6-45.6-23.9-57.4 0z\");\r\n  } else {\r\n    link.title = 'Add to favorite';\r\n    link.setAttribute('aria-label', 'Add to favorite');\r\n    link.dataset.favorite = 'add';\r\n    title.innerHTML = 'Add to favorite';\r\n    path.setAttribute(\"d\",\"M528.1 171.5L382 150.2 316.7 17.8c-11.7-23.6-45.6-23.9-57.4 0L194 150.2 47.9 171.5c-26.2 3.8-36.7 36.1-17.7 54.6l105.7 103-25 145.5c-4.5 26.3 23.2 46 46.4 33.7L288 439.6l130.7 68.7c23.2 12.2 50.9-7.4 46.4-33.7l-25-145.5 105.7-103c19-18.5 8.5-50.8-17.7-54.6zM388.6 312.3l23.7 138.4L288 385.4l-124.3 65.3 23.7-138.4-100.6-98 139-20.2 62.2-126 62.2 126 139 20.2-100.6 98z\");\r\n  }\r\n\r\n  svg.appendChild(title);\r\n  svg.appendChild(desc);\r\n  svg.appendChild(path);\r\n  link.append(svg);\r\n  favorite.append(link);\r\n  li.append(favorite);\r\n\r\n  const address = document.createElement('p');\r\n  address.innerHTML = restaurant.address;\r\n  li.append(address);\r\n\r\n  const more = document.createElement('a');\r\n  more.innerHTML = 'View Details';\r\n  more.setAttribute('class', 'details');\r\n  more.href = DBHelper.urlForRestaurant(restaurant);\r\n  li.append(more)\r\n\r\n  return li\r\n}\r\n\r\n\r\n/**\r\n* @description  Depends of resolutions initalize image map or google map.\r\n* @constructor\r\n*/\r\nwindow.initMap = () => {\r\n  if(window.innerWidth < 641) {\r\n    var googleMap = document.getElementById('map');\r\n    googleMap.style.display = 'none';\r\n    displayStaticMap();\r\n    self.staticMap = true;\r\n  } else {\r\n    var imageMap = document.getElementById('static-map');\r\n    imageMap.style.display = 'none';\r\n    displayMap();\r\n    self.staticMap = false;\r\n  }\r\n}\r\n\r\n\r\n/**\r\n* @description  Initialize Google map, called from HTML.\r\n* @constructor\r\n*/\r\ndisplayMap = () => {\r\n  if(self.staticMap === false) {\r\n    return;\r\n  }\r\n  let googleMap = document.getElementById('map');\r\n  googleMap.style.display = 'block';\r\n  self.staticMap = false;\r\n\r\n  let loc = {\r\n    lat: 40.722216,\r\n    lng: -73.987501\r\n  }\r\n  self.map = new google.maps.Map(document.getElementById('map'), {\r\n    zoom: 12,\r\n    center: loc,\r\n    scrollwheel: false\r\n  });\r\n  updateRestaurants();\r\n}\r\n\r\n\r\n/**\r\n* @description  Display Static map at Mobile resolutions.\r\n* @constructor\r\n*/\r\ndisplayStaticMap = () => {\r\n  if(self.staticMap === true) {\r\n    return;\r\n  }\r\n\r\n  let imageMap = document.getElementById('static-map');\r\n  imageMap.style.display = 'block';\r\n\r\n  imageMap.setAttribute('src',`https://maps.googleapis.com/maps/api/staticmap?center=40.722216,-73.987501&zoom=12&size=${window.innerWidth}x400&format=jpg&maptype=roadmap&markers=color:red`);\r\n  self.staticMap = true;\r\n\r\n  imageMap.addEventListener('click',function(e) {\r\n    e.preventDefault();\r\n    imageMap.style.display ='none';\r\n    displayMap();\r\n  });\r\n}\r\n\r\n\r\n/**\r\n* @description Add markers for current restaurants to the map.\r\n* @constructor\r\n* @param {object} restaurants - restaurants list.\r\n*/\r\naddMarkersToMap = (restaurants = self.restaurants) => {\r\n  restaurants.forEach(restaurant => {\r\n    // Add marker to the map\r\n    const marker = DBHelper.mapMarkerForRestaurant(restaurant, self.map);\r\n    google.maps.event.addListener(marker, 'click', () => {\r\n      window.location.href = marker.url\r\n    });\r\n    self.markers.push(marker);\r\n  });\r\n}\r\n\r\n\r\n/**\r\n * @description Calls click event of favorite/unfavorite button.\r\n * @constructor\r\n * @param {integer} id - restaurant identifier.\r\n * @param {object} link  - Link to add the event listener.\r\n */\r\n eventListenerFavorite = (link, id) => {\r\n   link.addEventListener('click', function(e) {\r\n     event.preventDefault();\r\n     self.is_favorite = (this.dataset.favorite == 'add') ? true : false;\r\n     DBHelper.putFavorite(id, self.is_favorite, (error, result) => {\r\n       if (!result) {\r\n         console.error(error);\r\n         return;\r\n       }\r\n       self.restaurants.forEach(restaurant => {\r\n         if( restaurant.id == id ) {\r\n           restaurant.is_favorite = self.is_favorite ? 'true' : 'false';\r\n         }\r\n       });\r\n\r\n       if( self.is_favorite ) {\r\n         link.title = 'Remove favorite';\r\n         link.setAttribute('aria-label', 'Remove favorite');\r\n         link.dataset.favorite = 'remove';\r\n         link.getElementsByTagName('title')[0].innerHTML = 'Remove favorite';\r\n         link.getElementsByTagName('path')[0].setAttribute(\"d\",\"M259.3 17.8L194 150.2 47.9 171.5c-26.2 3.8-36.7 36.1-17.7 54.6l105.7 103-25 145.5c-4.5 26.3 23.2 46 46.4 33.7L288 439.6l130.7 68.7c23.2 12.2 50.9-7.4 46.4-33.7l-25-145.5 105.7-103c19-18.5 8.5-50.8-17.7-54.6L382 150.2 316.7 17.8c-11.7-23.6-45.6-23.9-57.4 0z\");\r\n       } else {\r\n         link.title = 'Add to favorite';\r\n         link.setAttribute('aria-label', 'Add to favorite');\r\n         link.dataset.favorite = 'add';\r\n         link.getElementsByTagName('title')[0].innerHTML = 'Add to favorite';\r\n         link.getElementsByTagName('path')[0].setAttribute(\"d\",\"M528.1 171.5L382 150.2 316.7 17.8c-11.7-23.6-45.6-23.9-57.4 0L194 150.2 47.9 171.5c-26.2 3.8-36.7 36.1-17.7 54.6l105.7 103-25 145.5c-4.5 26.3 23.2 46 46.4 33.7L288 439.6l130.7 68.7c23.2 12.2 50.9-7.4 46.4-33.7l-25-145.5 105.7-103c19-18.5 8.5-50.8-17.7-54.6zM388.6 312.3l23.7 138.4L288 385.4l-124.3 65.3 23.7-138.4-100.6-98 139-20.2 62.2-126 62.2 126 139 20.2-100.6 98z\");\r\n       }\r\n     });\r\n   });\r\n }\r\n"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJub2RlX21vZHVsZXMvaWRiL2xpYi9pZGIuanMiLCJyZXNvdXJjZXMvanMvZGJoZWxwZXIuanMiLCJyZXNvdXJjZXMvanMvbWFpbi5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQ0FBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN2VEEsTUFBTSxNQUFNLFFBQVEsS0FBUixDQUFaO0FBQ0EsTUFBTSxTQUFTLGVBQWY7QUFDQSxNQUFNLGtCQUFr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QixxQkFBVyxXQUFYLEdBQXlCLEtBQUssV0FBTCxHQUFtQixNQUFuQixHQUE0QixPQUFyRDtBQUNEO0FBQ0YsT0FKRDs7QUFNQSxVQUFJLEtBQUssV0FBVCxFQUF1QjtBQUNyQixhQUFLLEtBQUwsR0FBYSxpQkFBYjtBQUNBLGFBQUssWUFBTCxDQUFrQixZQUFsQixFQUFnQyxpQkFBaEM7QUFDQSxhQUFLLE9BQUwsQ0FBYSxRQUFiLEdBQXdCLFFBQXhCO0FBQ0EsYUFBSyxvQkFBTCxDQUEwQixPQUExQixFQUFtQyxDQUFuQyxFQUFzQyxTQUF0QyxHQUFrRCxpQkFBbEQ7QUFDQSxhQUFLLG9CQUFMLENBQTBCLE1BQTFCLEVBQWtDLENBQWxDLEVBQXFDLFlBQXJDLENBQWtELEdBQWxELEVBQXNELGtRQUF0RDtBQUNELE9BTkQsTUFNTztBQUNMLGFBQUssS0FBTCxHQUFhLGlCQUFiO0FBQ0EsYUFBSyxZQUFMLENBQWtCLFlBQWxCLEVBQWdDLGlCQUFoQztBQUNBLGFBQUssT0FBTCxDQUFhLFFBQWIsR0FBd0IsS0FBeEI7QUFDQSxhQUFLLG9CQUFMLENBQTBCLE9BQTFCLEVBQW1DLENBQW5DLEVBQXNDLFNBQXRDLEdBQWtELGlCQUFsRDtBQUNBLGFBQUssb0JBQUwsQ0FBMEIsTUFBMUIsRUFBa0MsQ0FBbEMsRUFBcUMsWUFBckMsQ0FBa0QsR0FBbEQsRUFBc0Qsa1hBQXREO0FBQ0Q7QUFDRixLQXhCRDtBQXlCRCxHQTVCRDtBQTZCRCxDQTlCRCIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uKCl7ZnVuY3Rpb24gcihlLG4sdCl7ZnVuY3Rpb24gbyhpLGYpe2lmKCFuW2ldKXtpZighZVtpXSl7dmFyIGM9XCJmdW5jdGlvblwiPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZTtpZighZiYmYylyZXR1cm4gYyhpLCEwKTtpZih1KXJldHVybiB1KGksITApO3ZhciBhPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIraStcIidcIik7dGhyb3cgYS5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGF9dmFyIHA9bltpXT17ZXhwb3J0czp7fX07ZVtpXVswXS5jYWxsKHAuZXhwb3J0cyxmdW5jdGlvbihyKXt2YXIgbj1lW2ldWzFdW3JdO3JldHVybiBvKG58fHIpfSxwLHAuZXhwb3J0cyxyLGUsbix0KX1yZXR1cm4gbltpXS5leHBvcnRzfWZvcih2YXIgdT1cImZ1bmN0aW9uXCI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlLGk9MDtpPHQubGVuZ3RoO2krKylvKHRbaV0pO3JldHVybiBvfXJldHVybiByfSkoKSIsIid1c2Ugc3RyaWN0JztcblxuKGZ1bmN0aW9uKCkge1xuICBmdW5jdGlvbiB0b0FycmF5KGFycikge1xuICAgIHJldHVybiBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcnIpO1xuICB9XG5cbiAgZnVuY3Rpb24gcHJvbWlzaWZ5UmVxdWVzdChyZXF1ZXN0KSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgcmVxdWVzdC5vbnN1Y2Nlc3MgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmVzb2x2ZShyZXF1ZXN0LnJlc3VsdCk7XG4gICAgICB9O1xuXG4gICAgICByZXF1ZXN0Lm9uZXJyb3IgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmVqZWN0KHJlcXVlc3QuZXJyb3IpO1xuICAgICAgfTtcbiAgICB9KTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHByb21pc2lmeVJlcXVlc3RDYWxsKG9iaiwgbWV0aG9kLCBhcmdzKSB7XG4gICAgdmFyIHJlcXVlc3Q7XG4gICAgdmFyIHAgPSBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgIHJlcXVlc3QgPSBvYmpbbWV0aG9kXS5hcHBseShvYmosIGFyZ3MpO1xuICAgICAgcHJvbWlzaWZ5UmVxdWVzdChyZXF1ZXN0KS50aGVuKHJlc29sdmUsIHJlamVjdCk7XG4gICAgfSk7XG5cbiAgICBwLnJlcXVlc3QgPSByZXF1ZXN0O1xuICAgIHJldHVybiBwO1xuICB9XG5cbiAgZnVuY3Rpb24gcHJvbWlzaWZ5Q3Vyc29yUmVxdWVzdENhbGwob2JqLCBtZXRob2QsIGFyZ3MpIHtcbiAgICB2YXIgcCA9IHByb21pc2lmeVJlcXVlc3RDYWxsKG9iaiwgbWV0aG9kLCBhcmdzKTtcbiAgICByZXR1cm4gcC50aGVuKGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICBpZiAoIXZhbHVlKSByZXR1cm47XG4gICAgICByZXR1cm4gbmV3IEN1cnNvcih2YWx1ZSwgcC5yZXF1ZXN0KTtcbiAgICB9KTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHByb3h5UHJvcGVydGllcyhQcm94eUNsYXNzLCB0YXJnZXRQcm9wLCBwcm9wZXJ0aWVzKSB7XG4gICAgcHJvcGVydGllcy5mb3JFYWNoKGZ1bmN0aW9uKHByb3ApIHtcbiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShQcm94eUNsYXNzLnByb3RvdHlwZSwgcHJvcCwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiB0aGlzW3RhcmdldFByb3BdW3Byb3BdO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uKHZhbCkge1xuICAgICAgICAgIHRoaXNbdGFyZ2V0UHJvcF1bcHJvcF0gPSB2YWw7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG5cbiAgZnVuY3Rpb24gcHJveHlSZXF1ZXN0TWV0aG9kcyhQcm94eUNsYXNzLCB0YXJnZXRQcm9wLCBDb25zdHJ1Y3RvciwgcHJvcGVydGllcykge1xuICAgIHByb3BlcnRpZXMuZm9yRWFjaChmdW5jdGlvbihwcm9wKSB7XG4gICAgICBpZiAoIShwcm9wIGluIENvbnN0cnVjdG9yLnByb3RvdHlwZSkpIHJldHVybjtcbiAgICAgIFByb3h5Q2xhc3MucHJvdG90eXBlW3Byb3BdID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBwcm9taXNpZnlSZXF1ZXN0Q2FsbCh0aGlzW3RhcmdldFByb3BdLCBwcm9wLCBhcmd1bWVudHMpO1xuICAgICAgfTtcbiAgICB9KTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHByb3h5TWV0aG9kcyhQcm94eUNsYXNzLCB0YXJnZXRQcm9wLCBDb25zdHJ1Y3RvciwgcHJvcGVydGllcykge1xuICAgIHByb3BlcnRpZXMuZm9yRWFjaChmdW5jdGlvbihwcm9wKSB7XG4gICAgICBpZiAoIShwcm9wIGluIENvbnN0cnVjdG9yLnByb3RvdHlwZSkpIHJldHVybjtcbiAgICAgIFByb3h5Q2xhc3MucHJvdG90eXBlW3Byb3BdID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzW3RhcmdldFByb3BdW3Byb3BdLmFwcGx5KHRoaXNbdGFyZ2V0UHJvcF0sIGFyZ3VtZW50cyk7XG4gICAgICB9O1xuICAgIH0pO1xuICB9XG5cbiAgZnVuY3Rpb24gcHJveHlDdXJzb3JSZXF1ZXN0TWV0aG9kcyhQcm94eUNsYXNzLCB0YXJnZXRQcm9wLCBDb25zdHJ1Y3RvciwgcHJvcGVydGllcykge1xuICAgIHByb3BlcnRpZXMuZm9yRWFjaChmdW5jdGlvbihwcm9wKSB7XG4gICAgICBpZiAoIShwcm9wIGluIENvbnN0cnVjdG9yLnByb3RvdHlwZSkpIHJldHVybjtcbiAgICAgIFByb3h5Q2xhc3MucHJvdG90eXBlW3Byb3BdID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBwcm9taXNpZnlDdXJzb3JSZXF1ZXN0Q2FsbCh0aGlzW3RhcmdldFByb3BdLCBwcm9wLCBhcmd1bWVudHMpO1xuICAgICAgfTtcbiAgICB9KTtcbiAgfVxuXG4gIGZ1bmN0aW9uIEluZGV4KGluZGV4KSB7XG4gICAgdGhpcy5faW5kZXggPSBpbmRleDtcbiAgfVxuXG4gIHByb3h5UHJvcGVydGllcyhJbmRleCwgJ19pbmRleCcsIFtcbiAgICAnbmFtZScsXG4gICAgJ2tleVBhdGgnLFxuICAgICdtdWx0aUVudHJ5JyxcbiAgICAndW5pcXVlJ1xuICBdKTtcblxuICBwcm94eVJlcXVlc3RNZXRob2RzKEluZGV4LCAnX2luZGV4JywgSURCSW5kZXgsIFtcbiAgICAnZ2V0JyxcbiAgICAnZ2V0S2V5JyxcbiAgICAnZ2V0QWxsJyxcbiAgICAnZ2V0QWxsS2V5cycsXG4gICAgJ2NvdW50J1xuICBdKTtcblxuICBwcm94eUN1cnNvclJlcXVlc3RNZXRob2RzKEluZGV4LCAnX2luZGV4JywgSURCSW5kZXgsIFtcbiAgICAnb3BlbkN1cnNvcicsXG4gICAgJ29wZW5LZXlDdXJzb3InXG4gIF0pO1xuXG4gIGZ1bmN0aW9uIEN1cnNvcihjdXJzb3IsIHJlcXVlc3QpIHtcbiAgICB0aGlzLl9jdXJzb3IgPSBjdXJzb3I7XG4gICAgdGhpcy5fcmVxdWVzdCA9IHJlcXVlc3Q7XG4gIH1cblxuICBwcm94eVByb3BlcnRpZXMoQ3Vyc29yLCAnX2N1cnNvcicsIFtcbiAgICAnZGlyZWN0aW9uJyxcbiAgICAna2V5JyxcbiAgICAncHJpbWFyeUtleScsXG4gICAgJ3ZhbHVlJ1xuICBdKTtcblxuICBwcm94eVJlcXVlc3RNZXRob2RzKEN1cnNvciwgJ19jdXJzb3InLCBJREJDdXJzb3IsIFtcbiAgICAndXBkYXRlJyxcbiAgICAnZGVsZXRlJ1xuICBdKTtcblxuICAvLyBwcm94eSAnbmV4dCcgbWV0aG9kc1xuICBbJ2FkdmFuY2UnLCAnY29udGludWUnLCAnY29udGludWVQcmltYXJ5S2V5J10uZm9yRWFjaChmdW5jdGlvbihtZXRob2ROYW1lKSB7XG4gICAgaWYgKCEobWV0aG9kTmFtZSBpbiBJREJDdXJzb3IucHJvdG90eXBlKSkgcmV0dXJuO1xuICAgIEN1cnNvci5wcm90b3R5cGVbbWV0aG9kTmFtZV0gPSBmdW5jdGlvbigpIHtcbiAgICAgIHZhciBjdXJzb3IgPSB0aGlzO1xuICAgICAgdmFyIGFyZ3MgPSBhcmd1bWVudHM7XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCkudGhlbihmdW5jdGlvbigpIHtcbiAgICAgICAgY3Vyc29yLl9jdXJzb3JbbWV0aG9kTmFtZV0uYXBwbHkoY3Vyc29yLl9jdXJzb3IsIGFyZ3MpO1xuICAgICAgICByZXR1cm4gcHJvbWlzaWZ5UmVxdWVzdChjdXJzb3IuX3JlcXVlc3QpLnRoZW4oZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgICAgICBpZiAoIXZhbHVlKSByZXR1cm47XG4gICAgICAgICAgcmV0dXJuIG5ldyBDdXJzb3IodmFsdWUsIGN1cnNvci5fcmVxdWVzdCk7XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfTtcbiAgfSk7XG5cbiAgZnVuY3Rpb24gT2JqZWN0U3RvcmUoc3RvcmUpIHtcbiAgICB0aGlzLl9zdG9yZSA9IHN0b3JlO1xuICB9XG5cbiAgT2JqZWN0U3RvcmUucHJvdG90eXBlLmNyZWF0ZUluZGV4ID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIG5ldyBJbmRleCh0aGlzLl9zdG9yZS5jcmVhdGVJbmRleC5hcHBseSh0aGlzLl9zdG9yZSwgYXJndW1lbnRzKSk7XG4gIH07XG5cbiAgT2JqZWN0U3RvcmUucHJvdG90eXBlLmluZGV4ID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIG5ldyBJbmRleCh0aGlzLl9zdG9yZS5pbmRleC5hcHBseSh0aGlzLl9zdG9yZSwgYXJndW1lbnRzKSk7XG4gIH07XG5cbiAgcHJveHlQcm9wZXJ0aWVzKE9iamVjdFN0b3JlLCAnX3N0b3JlJywgW1xuICAgICduYW1lJyxcbiAgICAna2V5UGF0aCcsXG4gICAgJ2luZGV4TmFtZXMnLFxuICAgICdhdXRvSW5jcmVtZW50J1xuICBdKTtcblxuICBwcm94eVJlcXVlc3RNZXRob2RzKE9iamVjdFN0b3JlLCAnX3N0b3JlJywgSURCT2JqZWN0U3RvcmUsIFtcbiAgICAncHV0JyxcbiAgICAnYWRkJyxcbiAgICAnZGVsZXRlJyxcbiAgICAnY2xlYXInLFxuICAgICdnZXQnLFxuICAgICdnZXRBbGwnLFxuICAgICdnZXRLZXknLFxuICAgICdnZXRBbGxLZXlzJyxcbiAgICAnY291bnQnXG4gIF0pO1xuXG4gIHByb3h5Q3Vyc29yUmVxdWVzdE1ldGhvZHMoT2JqZWN0U3RvcmUsICdfc3RvcmUnLCBJREJPYmplY3RTdG9yZSwgW1xuICAgICdvcGVuQ3Vyc29yJyxcbiAgICAnb3BlbktleUN1cnNvcidcbiAgXSk7XG5cbiAgcHJveHlNZXRob2RzKE9iamVjdFN0b3JlLCAnX3N0b3JlJywgSURCT2JqZWN0U3RvcmUsIFtcbiAgICAnZGVsZXRlSW5kZXgnXG4gIF0pO1xuXG4gIGZ1bmN0aW9uIFRyYW5zYWN0aW9uKGlkYlRyYW5zYWN0aW9uKSB7XG4gICAgdGhpcy5fdHggPSBpZGJUcmFuc2FjdGlvbjtcbiAgICB0aGlzLmNvbXBsZXRlID0gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICBpZGJUcmFuc2FjdGlvbi5vbmNvbXBsZXRlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJlc29sdmUoKTtcbiAgICAgIH07XG4gICAgICBpZGJUcmFuc2FjdGlvbi5vbmVycm9yID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJlamVjdChpZGJUcmFuc2FjdGlvbi5lcnJvcik7XG4gICAgICB9O1xuICAgICAgaWRiVHJhbnNhY3Rpb24ub25hYm9ydCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZWplY3QoaWRiVHJhbnNhY3Rpb24uZXJyb3IpO1xuICAgICAgfTtcbiAgICB9KTtcbiAgfVxuXG4gIFRyYW5zYWN0aW9uLnByb3RvdHlwZS5vYmplY3RTdG9yZSA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBuZXcgT2JqZWN0U3RvcmUodGhpcy5fdHgub2JqZWN0U3RvcmUuYXBwbHkodGhpcy5fdHgsIGFyZ3VtZW50cykpO1xuICB9O1xuXG4gIHByb3h5UHJvcGVydGllcyhUcmFuc2FjdGlvbiwgJ190eCcsIFtcbiAgICAnb2JqZWN0U3RvcmVOYW1lcycsXG4gICAgJ21vZGUnXG4gIF0pO1xuXG4gIHByb3h5TWV0aG9kcyhUcmFuc2FjdGlvbiwgJ190eCcsIElEQlRyYW5zYWN0aW9uLCBbXG4gICAgJ2Fib3J0J1xuICBdKTtcblxuICBmdW5jdGlvbiBVcGdyYWRlREIoZGIsIG9sZFZlcnNpb24sIHRyYW5zYWN0aW9uKSB7XG4gICAgdGhpcy5fZGIgPSBkYjtcbiAgICB0aGlzLm9sZFZlcnNpb24gPSBvbGRWZXJzaW9uO1xuICAgIHRoaXMudHJhbnNhY3Rpb24gPSBuZXcgVHJhbnNhY3Rpb24odHJhbnNhY3Rpb24pO1xuICB9XG5cbiAgVXBncmFkZURCLnByb3RvdHlwZS5jcmVhdGVPYmplY3RTdG9yZSA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBuZXcgT2JqZWN0U3RvcmUodGhpcy5fZGIuY3JlYXRlT2JqZWN0U3RvcmUuYXBwbHkodGhpcy5fZGIsIGFyZ3VtZW50cykpO1xuICB9O1xuXG4gIHByb3h5UHJvcGVydGllcyhVcGdyYWRlREIsICdfZGInLCBbXG4gICAgJ25hbWUnLFxuICAgICd2ZXJzaW9uJyxcbiAgICAnb2JqZWN0U3RvcmVOYW1lcydcbiAgXSk7XG5cbiAgcHJveHlNZXRob2RzKFVwZ3JhZGVEQiwgJ19kYicsIElEQkRhdGFiYXNlLCBbXG4gICAgJ2RlbGV0ZU9iamVjdFN0b3JlJyxcbiAgICAnY2xvc2UnXG4gIF0pO1xuXG4gIGZ1bmN0aW9uIERCKGRiKSB7XG4gICAgdGhpcy5fZGIgPSBkYjtcbiAgfVxuXG4gIERCLnByb3RvdHlwZS50cmFuc2FjdGlvbiA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBuZXcgVHJhbnNhY3Rpb24odGhpcy5fZGIudHJhbnNhY3Rpb24uYXBwbHkodGhpcy5fZGIsIGFyZ3VtZW50cykpO1xuICB9O1xuXG4gIHByb3h5UHJvcGVydGllcyhEQiwgJ19kYicsIFtcbiAgICAnbmFtZScsXG4gICAgJ3ZlcnNpb24nLFxuICAgICdvYmplY3RTdG9yZU5hbWVzJ1xuICBdKTtcblxuICBwcm94eU1ldGhvZHMoREIsICdfZGInLCBJREJEYXRhYmFzZSwgW1xuICAgICdjbG9zZSdcbiAgXSk7XG5cbiAgLy8gQWRkIGN1cnNvciBpdGVyYXRvcnNcbiAgLy8gVE9ETzogcmVtb3ZlIHRoaXMgb25jZSBicm93c2VycyBkbyB0aGUgcmlnaHQgdGhpbmcgd2l0aCBwcm9taXNlc1xuICBbJ29wZW5DdXJzb3InLCAnb3BlbktleUN1cnNvciddLmZvckVhY2goZnVuY3Rpb24oZnVuY05hbWUpIHtcbiAgICBbT2JqZWN0U3RvcmUsIEluZGV4XS5mb3JFYWNoKGZ1bmN0aW9uKENvbnN0cnVjdG9yKSB7XG4gICAgICBDb25zdHJ1Y3Rvci5wcm90b3R5cGVbZnVuY05hbWUucmVwbGFjZSgnb3BlbicsICdpdGVyYXRlJyldID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBhcmdzID0gdG9BcnJheShhcmd1bWVudHMpO1xuICAgICAgICB2YXIgY2FsbGJhY2sgPSBhcmdzW2FyZ3MubGVuZ3RoIC0gMV07XG4gICAgICAgIHZhciBuYXRpdmVPYmplY3QgPSB0aGlzLl9zdG9yZSB8fCB0aGlzLl9pbmRleDtcbiAgICAgICAgdmFyIHJlcXVlc3QgPSBuYXRpdmVPYmplY3RbZnVuY05hbWVdLmFwcGx5KG5hdGl2ZU9iamVjdCwgYXJncy5zbGljZSgwLCAtMSkpO1xuICAgICAgICByZXF1ZXN0Lm9uc3VjY2VzcyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIGNhbGxiYWNrKHJlcXVlc3QucmVzdWx0KTtcbiAgICAgICAgfTtcbiAgICAgIH07XG4gICAgfSk7XG4gIH0pO1xuXG4gIC8vIHBvbHlmaWxsIGdldEFsbFxuICBbSW5kZXgsIE9iamVjdFN0b3JlXS5mb3JFYWNoKGZ1bmN0aW9uKENvbnN0cnVjdG9yKSB7XG4gICAgaWYgKENvbnN0cnVjdG9yLnByb3RvdHlwZS5nZXRBbGwpIHJldHVybjtcbiAgICBDb25zdHJ1Y3Rvci5wcm90b3R5cGUuZ2V0QWxsID0gZnVuY3Rpb24ocXVlcnksIGNvdW50KSB7XG4gICAgICB2YXIgaW5zdGFuY2UgPSB0aGlzO1xuICAgICAgdmFyIGl0ZW1zID0gW107XG5cbiAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlKSB7XG4gICAgICAgIGluc3RhbmNlLml0ZXJhdGVDdXJzb3IocXVlcnksIGZ1bmN0aW9uKGN1cnNvcikge1xuICAgICAgICAgIGlmICghY3Vyc29yKSB7XG4gICAgICAgICAgICByZXNvbHZlKGl0ZW1zKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9XG4gICAgICAgICAgaXRlbXMucHVzaChjdXJzb3IudmFsdWUpO1xuXG4gICAgICAgICAgaWYgKGNvdW50ICE9PSB1bmRlZmluZWQgJiYgaXRlbXMubGVuZ3RoID09IGNvdW50KSB7XG4gICAgICAgICAgICByZXNvbHZlKGl0ZW1zKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9XG4gICAgICAgICAgY3Vyc29yLmNvbnRpbnVlKCk7XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfTtcbiAgfSk7XG5cbiAgdmFyIGV4cCA9IHtcbiAgICBvcGVuOiBmdW5jdGlvbihuYW1lLCB2ZXJzaW9uLCB1cGdyYWRlQ2FsbGJhY2spIHtcbiAgICAgIHZhciBwID0gcHJvbWlzaWZ5UmVxdWVzdENhbGwoaW5kZXhlZERCLCAnb3BlbicsIFtuYW1lLCB2ZXJzaW9uXSk7XG4gICAgICB2YXIgcmVxdWVzdCA9IHAucmVxdWVzdDtcblxuICAgICAgcmVxdWVzdC5vbnVwZ3JhZGVuZWVkZWQgPSBmdW5jdGlvbihldmVudCkge1xuICAgICAgICBpZiAodXBncmFkZUNhbGxiYWNrKSB7XG4gICAgICAgICAgdXBncmFkZUNhbGxiYWNrKG5ldyBVcGdyYWRlREIocmVxdWVzdC5yZXN1bHQsIGV2ZW50Lm9sZFZlcnNpb24sIHJlcXVlc3QudHJhbnNhY3Rpb24pKTtcbiAgICAgICAgfVxuICAgICAgfTtcblxuICAgICAgcmV0dXJuIHAudGhlbihmdW5jdGlvbihkYikge1xuICAgICAgICByZXR1cm4gbmV3IERCKGRiKTtcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgZGVsZXRlOiBmdW5jdGlvbihuYW1lKSB7XG4gICAgICByZXR1cm4gcHJvbWlzaWZ5UmVxdWVzdENhbGwoaW5kZXhlZERCLCAnZGVsZXRlRGF0YWJhc2UnLCBbbmFtZV0pO1xuICAgIH1cbiAgfTtcblxuICBpZiAodHlwZW9mIG1vZHVsZSAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICBtb2R1bGUuZXhwb3J0cyA9IGV4cDtcbiAgICBtb2R1bGUuZXhwb3J0cy5kZWZhdWx0ID0gbW9kdWxlLmV4cG9ydHM7XG4gIH1cbiAgZWxzZSB7XG4gICAgc2VsZi5pZGIgPSBleHA7XG4gIH1cbn0oKSk7XG4iLCJjb25zdCBpZGIgPSByZXF1aXJlKCdpZGInKTtcclxuY29uc3QgSURCX0RCID0gJ3Jlc3RhdXJhbnQtZGInO1xyXG5jb25zdCBJREJfUkVTVEFVUkFOVFMgPSAncmVzdGF1cmFudHMnO1xyXG5jb25zdCBJREJfUkVWSUVXUyA9ICdyZXZpZXdzJztcclxuXHJcbiAvKipcclxuICAqIEBkZXNjcmlwdGlvbiAgQ29tbW9uIGRhdGFiYXNlIGhlbHBlciBmdW5jdGlvbnMuXHJcbiAgKiBAY29uc3RydWN0b3JcclxuICAqL1xyXG5jbGFzcyBEQkhlbHBlciB7XHJcbiAvKipcclxuICAqIEBkZXNjcmlwdGlvbiAgRGF0YWJhc2UgVVJMLiBDaGFuZ2UgdGhpcyB0byByZXN0YXVyYW50cy5qc29uIGZpbGUgbG9jYXRpb24gb24geW91ciBzZXJ2ZXIuXHJcbiAgKiBAY29uc3RydWN0b3JcclxuICAqL1xyXG4gIHN0YXRpYyBnZXQgUkVTVEFVUkFOVFNfVVJMKCkge1xyXG4gICAgY29uc3QgcG9ydCA9IDEzMzcgLy8gQ2hhbmdlIHRoaXMgdG8geW91ciBzZXJ2ZXIgcG9ydFxyXG4gICAgcmV0dXJuIGBodHRwOi8vbG9jYWxob3N0OiR7cG9ydH0vcmVzdGF1cmFudHNgO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQGRlc2NyaXB0aW9uICBEYXRhYmFzZSBVUkwuIENoYW5nZSB0aGlzIHRvIHJlc3RhdXJhbnRzLmpzb24gZmlsZSBsb2NhdGlvbiBvbiB5b3VyIHNlcnZlci5cclxuICAgKiBAY29uc3RydWN0b3JcclxuICAgKi9cclxuICAgc3RhdGljIGdldCBSRVZJRVdTX1VSTCgpIHtcclxuICAgICBjb25zdCBwb3J0ID0gMTMzNyAvLyBDaGFuZ2UgdGhpcyB0byB5b3VyIHNlcnZlciBwb3J0XHJcbiAgICAgcmV0dXJuIGBodHRwOi8vbG9jYWxob3N0OiR7cG9ydH0vcmV2aWV3c2A7XHJcbiAgIH1cclxuXHJcblxyXG4gIC8qKlxyXG4gICAqIEBkZXNjcmlwdGlvbiAgT3BlbiBkYXRhYmFzZS5cclxuICAgKiBAY29uc3RydWN0b3JcclxuICAgKi9cclxuICBzdGF0aWMgb3BlbkluZGV4ZWREQigpIHtcclxuICAgIC8vIElmIHRoZSBicm93c2VyIGRvZXNuJ3Qgc3VwcG9ydCBzZXJ2aWNlIHdvcmtlcixcclxuICAgIC8vIHdlIGRvbid0IGNhcmUgYWJvdXQgaGF2aW5nIGEgZGF0YWJhc2VcclxuICAgIGlmICghbmF2aWdhdG9yLnNlcnZpY2VXb3JrZXIpIHtcclxuICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO1xyXG4gICAgfVxyXG5cclxuICAgIHRoaXMuZGJQcm9taXNlID0gaWRiLm9wZW4oSURCX0RCLCAxLCBmdW5jdGlvbiAodXBncmFkZURiKSB7XHJcbiAgICAgIHN3aXRjaCAodXBncmFkZURiLm9sZFZlcnNpb24pIHtcclxuICAgICAgICBjYXNlIDA6XHJcbiAgICAgICAgY2FzZSAxOlxyXG4gICAgICAgICAgY29uc3Qgc3RvcmVSZXN0YXVyYW50ID0gdXBncmFkZURiLmNyZWF0ZU9iamVjdFN0b3JlKElEQl9SRVNUQVVSQU5UUywge1xyXG4gICAgICAgICAgICBrZXlQYXRoOiAnaWQnXHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICAgIHN0b3JlUmVzdGF1cmFudC5jcmVhdGVJbmRleCgnYnktaWQnLCAnaWQnLCB7IHVuaXF1ZTogdHJ1ZSB9KTtcclxuXHJcbiAgICAgICAgICBjb25zdCBzdG9yZVJldmlld3MgPSB1cGdyYWRlRGIuY3JlYXRlT2JqZWN0U3RvcmUoSURCX1JFVklFV1MsIHtcclxuICAgICAgICAgICAga2V5UGF0aDogJ2lkJ1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgICBzdG9yZVJldmlld3MuY3JlYXRlSW5kZXgoJ2J5LWlkJywgXCJpZFwiLCB7IHVuaXF1ZTogdHJ1ZSB9KTtcclxuICAgICAgICAgIHN0b3JlUmV2aWV3cy5jcmVhdGVJbmRleCgnYnktcmVzdGF1cmFudC1pZCcsICdyZXN0YXVyYW50X2lkJyk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcblxyXG4gIC8qKlxyXG4gICAqIEBkZXNjcmlwdGlvbiAgU2F2ZSBkYXRhIHJlc3RhdXJhbnQuXHJcbiAgICogQGNvbnN0cnVjdG9yXHJcbiAgICogQHBhcmFtIHtvYmplY3R9IE9iamVjdCBsaXN0IC0gT2JqZWN0IGxpa2UgcmVzdGF1cmFudCwgcmV2ZWl3LCAuLi5cclxuICAgKi9cclxuICBzdGF0aWMgc3RvcmVJbmRleGVkREIodGFibGUsIG9iamVjdHMpIHtcclxuICAgIHRoaXMuZGJQcm9taXNlLnRoZW4oZnVuY3Rpb24gKGRiKSB7XHJcbiAgICAgIGlmKCFkYikgcmV0dXJuO1xyXG5cclxuICAgICAgbGV0IHR4ID0gZGIudHJhbnNhY3Rpb24odGFibGUsICdyZWFkd3JpdGUnKTtcclxuICAgICAgY29uc3Qgc3RvcmUgPSB0eC5vYmplY3RTdG9yZSh0YWJsZSk7XHJcbiAgICAgIGlmIChBcnJheS5pc0FycmF5KG9iamVjdHMpKSB7XHJcbiAgICAgICAgb2JqZWN0cy5mb3JFYWNoKGZ1bmN0aW9uKG9iamVjdCl7XHJcbiAgICAgICAgICBzdG9yZS5wdXQob2JqZWN0KTtcclxuICAgICAgICB9KTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBzdG9yZS5wdXQob2JqZWN0cyk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcblxyXG4gIC8qKlxyXG4gICAqIEBkZXNjcmlwdGlvbiAgR2V0IGEgY29sbGVjdGlvbiBvZiBvYmplY3RzIGZyb20gaW5kZXhlZERCLlxyXG4gICAqIEBjb25zdHJ1Y3RvclxyXG4gICAqL1xyXG4gIHN0YXRpYyBnZXRTdG9yZWRPYmplY3RzKHRhYmxlKSB7XHJcbiAgICByZXR1cm4gdGhpcy5kYlByb21pc2UudGhlbihmdW5jdGlvbihkYikge1xyXG4gICAgICBpZighZGIpIHJldHVybjtcclxuICAgICAgY29uc3Qgc3RvcmUgPSBkYi50cmFuc2FjdGlvbih0YWJsZSkub2JqZWN0U3RvcmUodGFibGUpO1xyXG4gICAgICByZXR1cm4gc3RvcmUuZ2V0QWxsKCk7XHJcbiAgICB9KVxyXG4gIH1cclxuXHJcblxyXG4gIC8qKlxyXG4gICAqIEBkZXNjcmlwdGlvbiAgR2V0IG9iamVjdCBmcm9tIGluZGV4ZWREQiBieSBpbmRleFxyXG4gICAqIEBjb25zdHJ1Y3RvciB7aW50fSBpZCAtIFJlc3RhdXJhbnQgaWRcclxuICAgKi9cclxuICBzdGF0aWMgZ2V0U3RvcmVkT2JqZWN0QnlJZCh0YWJsZSwgaWR4LCBpZCkge1xyXG4gICAgcmV0dXJuIHRoaXMuZGJQcm9taXNlLnRoZW4oZnVuY3Rpb24oZGIpIHtcclxuICAgICAgaWYoIWRiKSByZXR1cm47XHJcblxyXG4gICAgICBjb25zdCBzdG9yZSA9IGRiLnRyYW5zYWN0aW9uKHRhYmxlKS5vYmplY3RTdG9yZSh0YWJsZSk7XHJcbiAgICAgIGNvbnN0IGluZGV4SWQgPSBzdG9yZS5pbmRleChpZHgpO1xyXG4gICAgICByZXR1cm4gaW5kZXhJZC5nZXRBbGwoaWQpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuXHJcbiAvKipcclxuICAqIEBkZXNjcmlwdGlvbiAgRmV0Y2ggYWxsIHJlc3RhdXJhbnRzLlxyXG4gICogQGNvbnN0cnVjdG9yXHJcbiAgKiBAcGFyYW0ge2Z1bmN0aW9ufSBjYWxsYmFjayAtIENhbGxiYWNrIGZ1bmN0aW9uLlxyXG4gICovXHJcbiAgc3RhdGljIGZldGNoUmVzdGF1cmFudHMoY2FsbGJhY2spIHtcclxuICAgIGZldGNoKERCSGVscGVyLlJFU1RBVVJBTlRTX1VSTClcclxuICAgICAgLnRoZW4ocmVzcG9uc2UgPT4gcmVzcG9uc2UuanNvbigpKVxyXG4gICAgICAudGhlbihyZXN0YXVyYW50cyA9PiB7XHJcbiAgICAgICAgREJIZWxwZXIuc3RvcmVJbmRleGVkREIoSURCX1JFU1RBVVJBTlRTLCByZXN0YXVyYW50cyk7XHJcbiAgICAgICAgY2FsbGJhY2sobnVsbCwgcmVzdGF1cmFudHMpO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goZXJyb3IgPT4ge1xyXG4gICAgICAgIERCSGVscGVyLmdldFN0b3JlZE9iamVjdHMoSURCX1JFU1RBVVJBTlRTKVxyXG4gICAgICAgIC50aGVuKChzdG9yZWRSZXN0YXVyYW50cykgPT4ge1xyXG4gICAgICAgICAgY2FsbGJhY2sobnVsbCwgc3RvcmVkUmVzdGF1cmFudHMpO1xyXG4gICAgICAgIH0pLmNhdGNoKGVycm9yID0+IHtcclxuICAgICAgICAgIGNhbGxiYWNrKGVycm9yLCBudWxsKTtcclxuICAgICAgICB9KVxyXG4gICAgICB9KTtcclxuICB9XHJcblxyXG5cclxuIC8qKlxyXG4gICogQGRlc2NyaXB0aW9uICBGZXRjaCBhIHJlc3RhdXJhbnQgYnkgaXRzIElELlxyXG4gICogQGNvbnN0cnVjdG9yXHJcbiAgKiBAcGFyYW0ge2ludH0gaWQgLSBSZXN0YXVyYW50IGlkZW50aWZpZXIuXHJcbiAgKiBAcGFyYW0ge2Z1bmN0aW9ufSBjYWxsYmFjayAtIENhbGxiYWNrIGZ1bmN0aW9uLlxyXG4gICovXHJcbiAgc3RhdGljIGZldGNoUmVzdGF1cmFudEJ5SWQoaWQsIGNhbGxiYWNrKSB7XHJcbiAgICBmZXRjaChgJHtEQkhlbHBlci5SRVNUQVVSQU5UU19VUkx9LyR7aWR9YClcclxuICAgICAgLnRoZW4ocmVzcG9uc2UgPT4gcmVzcG9uc2UuanNvbigpKVxyXG4gICAgICAudGhlbihyZXN0YXVyYW50ID0+IHtcclxuICAgICAgICBEQkhlbHBlci5zdG9yZUluZGV4ZWREQihJREJfUkVTVEFVUkFOVFMsIHJlc3RhdXJhbnQpO1xyXG4gICAgICAgIGNhbGxiYWNrKG51bGwsIHJlc3RhdXJhbnQpO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goZXJyb3IgPT4ge1xyXG4gICAgICAgIERCSGVscGVyLmdldFN0b3JlZE9iamVjdEJ5SWQoSURCX1JFU1RBVVJBTlRTLCAnYnktaWQnICxpZClcclxuICAgICAgICAudGhlbigoc3RvcmVkUmVzdGF1cmFudCkgPT4ge1xyXG4gICAgICAgICAgY2FsbGJhY2sobnVsbCwgc3RvcmVkUmVzdGF1cmFudCk7XHJcbiAgICAgICAgfSkuY2F0Y2goZXJyb3IgPT4ge1xyXG4gICAgICAgICAgY2FsbGJhY2soZXJyb3IsIG51bGwpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgIH0pO1xyXG4gIH1cclxuXHJcblxyXG4gLyoqXHJcbiAgKiBAZGVzY3JpcHRpb24gIEZldGNoIHJlc3RhdXJhbnRzIGJ5IGEgY3Vpc2luZSB0eXBlIHdpdGggcHJvcGVyIGVycm9yIGhhbmRsaW5nLlxyXG4gICogQGNvbnN0cnVjdG9yXHJcbiAgKiBAcGFyYW0ge3N0cmluZ30gY3Vpc2luZSAtIE5laWdoYm9yaG9vZCBzZWxlY3RlZC5cclxuICAqIEBwYXJhbSB7ZnVuY3Rpb259IGNhbGxiYWNrIC0gQ2FsbGJhY2sgZnVuY3Rpb24uXHJcbiAgKi9cclxuICBzdGF0aWMgZmV0Y2hSZXN0YXVyYW50QnlDdWlzaW5lKGN1aXNpbmUsIGNhbGxiYWNrKSB7XHJcbiAgICAvLyBGZXRjaCBhbGwgcmVzdGF1cmFudHMgIHdpdGggcHJvcGVyIGVycm9yIGhhbmRsaW5nXHJcbiAgICBEQkhlbHBlci5mZXRjaFJlc3RhdXJhbnRzKChlcnJvciwgcmVzdGF1cmFudHMpID0+IHtcclxuICAgICAgaWYgKGVycm9yKSB7XHJcbiAgICAgICAgY2FsbGJhY2soZXJyb3IsIG51bGwpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIC8vIEZpbHRlciByZXN0YXVyYW50cyB0byBoYXZlIG9ubHkgZ2l2ZW4gY3Vpc2luZSB0eXBlXHJcbiAgICAgICAgY29uc3QgcmVzdWx0cyA9IHJlc3RhdXJhbnRzLmZpbHRlcihyID0+IHIuY3Vpc2luZV90eXBlID09IGN1aXNpbmUpO1xyXG4gICAgICAgIGNhbGxiYWNrKG51bGwsIHJlc3VsdHMpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG5cclxuIC8qKlxyXG4gICogQGRlc2NyaXB0aW9uICBGZXRjaCByZXN0YXVyYW50cyBieSBhIG5laWdoYm9yaG9vZCB3aXRoIHByb3BlciBlcnJvciBoYW5kbGluZy5cclxuICAqIEBjb25zdHJ1Y3RvclxyXG4gICogQHBhcmFtIHtzdHJpbmd9IG5laWdoYm9yaG9vZCAtIE5laWdoYm9yaG9vZCBzZWxlY3RlZC5cclxuICAqIEBwYXJhbSB7ZnVuY3Rpb259IGNhbGxiYWNrIC0gQ2FsbGJhY2sgZnVuY3Rpb24uXHJcbiAgKi9cclxuICBzdGF0aWMgZmV0Y2hSZXN0YXVyYW50QnlOZWlnaGJvcmhvb2QobmVpZ2hib3Job29kLCBjYWxsYmFjaykge1xyXG4gICAgLy8gRmV0Y2ggYWxsIHJlc3RhdXJhbnRzXHJcbiAgICBEQkhlbHBlci5mZXRjaFJlc3RhdXJhbnRzKChlcnJvciwgcmVzdGF1cmFudHMpID0+IHtcclxuICAgICAgaWYgKGVycm9yKSB7XHJcbiAgICAgICAgY2FsbGJhY2soZXJyb3IsIG51bGwpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIC8vIEZpbHRlciByZXN0YXVyYW50cyB0byBoYXZlIG9ubHkgZ2l2ZW4gbmVpZ2hib3Job29kXHJcbiAgICAgICAgY29uc3QgcmVzdWx0cyA9IHJlc3RhdXJhbnRzLmZpbHRlcihyID0+IHIubmVpZ2hib3Job29kID09IG5laWdoYm9yaG9vZCk7XHJcbiAgICAgICAgY2FsbGJhY2sobnVsbCwgcmVzdWx0cyk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcblxyXG4gLyoqXHJcbiAgKiBAZGVzY3JpcHRpb24gIEZldGNoIHJlc3RhdXJhbnRzIGJ5IGEgY3Vpc2luZSBhbmQgYSBuZWlnaGJvcmhvb2Qgd2l0aCBwcm9wZXIgZXJyb3IgaGFuZGxpbmcuXHJcbiAgKiBAY29uc3RydWN0b3JcclxuICAqIEBwYXJhbSB7c3RyaW5nfSBjdWlzaW5lIC0gQ3Vpc2luZSBzZWxlY3RlZC5cclxuICAqIEBwYXJhbSB7c3RyaW5nfSBuZWlnaGJvcmhvb2QgLSBOZWlnaGJvcmhvb2Qgc2VsZWN0ZWQuXHJcbiAgKiBAcGFyYW0ge2Z1bmN0aW9ufSBjYWxsYmFjayAtIENhbGxiYWNrIGZ1bmN0aW9uLlxyXG4gICovXHJcbiAgc3RhdGljIGZldGNoUmVzdGF1cmFudEJ5Q3Vpc2luZUFuZE5laWdoYm9yaG9vZChjdWlzaW5lLCBuZWlnaGJvcmhvb2QsIGNhbGxiYWNrKSB7XHJcbiAgICAvLyBGZXRjaCBhbGwgcmVzdGF1cmFudHNcclxuICAgIERCSGVscGVyLmZldGNoUmVzdGF1cmFudHMoKGVycm9yLCByZXN0YXVyYW50cykgPT4ge1xyXG4gICAgICBpZiAoZXJyb3IpIHtcclxuICAgICAgICBjYWxsYmFjayhlcnJvciwgbnVsbCk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgbGV0IHJlc3VsdHMgPSByZXN0YXVyYW50cztcclxuICAgICAgICBpZiAoY3Vpc2luZSAhPSAnYWxsJykgeyAvLyBmaWx0ZXIgYnkgY3Vpc2luZVxyXG4gICAgICAgICAgcmVzdWx0cyA9IHJlc3VsdHMuZmlsdGVyKHIgPT4gci5jdWlzaW5lX3R5cGUgPT0gY3Vpc2luZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChuZWlnaGJvcmhvb2QgIT0gJ2FsbCcpIHsgLy8gZmlsdGVyIGJ5IG5laWdoYm9yaG9vZFxyXG4gICAgICAgICAgcmVzdWx0cyA9IHJlc3VsdHMuZmlsdGVyKHIgPT4gci5uZWlnaGJvcmhvb2QgPT0gbmVpZ2hib3Job29kKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY2FsbGJhY2sobnVsbCwgcmVzdWx0cyk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcblxyXG4gLyoqXHJcbiAgKiBAZGVzY3JpcHRpb24gIEZldGNoIGFsbCBuZWlnaGJvcmhvb2RzIHdpdGggcHJvcGVyIGVycm9yIGhhbmRsaW5nLlxyXG4gICogQGNvbnN0cnVjdG9yXHJcbiAgKiBAcGFyYW0ge2Z1bmN0aW9ufSBjYWxsYmFjayAtIENhbGxiYWNrIGZ1bmN0aW9uLlxyXG4gICovXHJcbiAgc3RhdGljIGZldGNoTmVpZ2hib3Job29kcyhjYWxsYmFjaykge1xyXG4gICAgLy8gRmV0Y2ggYWxsIHJlc3RhdXJhbnRzXHJcbiAgICBEQkhlbHBlci5mZXRjaFJlc3RhdXJhbnRzKChlcnJvciwgcmVzdGF1cmFudHMpID0+IHtcclxuICAgICAgaWYgKGVycm9yKSB7XHJcbiAgICAgICAgY2FsbGJhY2soZXJyb3IsIG51bGwpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIC8vIEdldCBhbGwgbmVpZ2hib3Job29kcyBmcm9tIGFsbCByZXN0YXVyYW50c1xyXG4gICAgICAgIGNvbnN0IG5laWdoYm9yaG9vZHMgPSByZXN0YXVyYW50cy5tYXAoKHYsIGkpID0+IHJlc3RhdXJhbnRzW2ldLm5laWdoYm9yaG9vZClcclxuICAgICAgICAvLyBSZW1vdmUgZHVwbGljYXRlcyBmcm9tIG5laWdoYm9yaG9vZHNcclxuICAgICAgICBjb25zdCB1bmlxdWVOZWlnaGJvcmhvb2RzID0gbmVpZ2hib3Job29kcy5maWx0ZXIoKHYsIGkpID0+IG5laWdoYm9yaG9vZHMuaW5kZXhPZih2KSA9PSBpKVxyXG4gICAgICAgIGNhbGxiYWNrKG51bGwsIHVuaXF1ZU5laWdoYm9yaG9vZHMpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG5cclxuIC8qKlxyXG4gICogQGRlc2NyaXB0aW9uICBGZXRjaCBhbGwgY3Vpc2luZXMgd2l0aCBwcm9wZXIgZXJyb3IgaGFuZGxpbmcuXHJcbiAgKiBAY29uc3RydWN0b3JcclxuICAqIEBwYXJhbSB7ZnVuY3Rpb259IGNhbGxiYWNrIC0gQ2FsbGJhY2sgZnVuY3Rpb24uXHJcbiAgKi9cclxuICBzdGF0aWMgZmV0Y2hDdWlzaW5lcyhjYWxsYmFjaykge1xyXG4gICAgLy8gRmV0Y2ggYWxsIHJlc3RhdXJhbnRzXHJcbiAgICBEQkhlbHBlci5mZXRjaFJlc3RhdXJhbnRzKChlcnJvciwgcmVzdGF1cmFudHMpID0+IHtcclxuICAgICAgaWYgKGVycm9yKSB7XHJcbiAgICAgICAgY2FsbGJhY2soZXJyb3IsIG51bGwpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIC8vIEdldCBhbGwgY3Vpc2luZXMgZnJvbSBhbGwgcmVzdGF1cmFudHNcclxuICAgICAgICBjb25zdCBjdWlzaW5lcyA9IHJlc3RhdXJhbnRzLm1hcCgodiwgaSkgPT4gcmVzdGF1cmFudHNbaV0uY3Vpc2luZV90eXBlKVxyXG4gICAgICAgIC8vIFJlbW92ZSBkdXBsaWNhdGVzIGZyb20gY3Vpc2luZXNcclxuICAgICAgICBjb25zdCB1bmlxdWVDdWlzaW5lcyA9IGN1aXNpbmVzLmZpbHRlcigodiwgaSkgPT4gY3Vpc2luZXMuaW5kZXhPZih2KSA9PSBpKVxyXG4gICAgICAgIGNhbGxiYWNrKG51bGwsIHVuaXF1ZUN1aXNpbmVzKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuXHJcblxyXG4gIC8qKlxyXG4gICogQGRlc2NyaXB0aW9uICBGZXRjaCBhbGwgcmV2aWV3cy5cclxuICAqIEBjb25zdHJ1Y3RvclxyXG4gICogQHBhcmFtIHtmdW5jdGlvbn0gY2FsbGJhY2sgLSBDYWxsYmFjayBmdW5jdGlvbi5cclxuICAqL1xyXG4gIHN0YXRpYyBmZXRjaFJldmlld3MoY2FsbGJhY2spIHtcclxuICAgIGZldGNoKERCSGVscGVyLlJFVklFV1NfVVJMKVxyXG4gICAgICAudGhlbihyZXNwb25zZSA9PiByZXNwb25zZS5qc29uKCkpXHJcbiAgICAgIC50aGVuKHJldmlld3MgPT4ge1xyXG4gICAgICAgIERCSGVscGVyLnN0b3JlSW5kZXhlZERCKElEQl9SRVZJRVdTLCByZXZpZXdzKTtcclxuICAgICAgICBjYWxsYmFjayhudWxsLCByZXZpZXdzKTtcclxuICAgICAgfSlcclxuICAgICAgLmNhdGNoKGVycm9yID0+IHtcclxuICAgICAgICBEQkhlbHBlci5nZXRTdG9yZWRPYmplY3RzKElEQl9SRVZJRVdTKVxyXG4gICAgICAgIC50aGVuKChzdG9yZWRSZXZpZXdzKSA9PiB7XHJcbiAgICAgICAgICBjYWxsYmFjayhudWxsLCBzdG9yZWRSZXZpZXdzKTtcclxuICAgICAgICB9KS5jYXRjaChlcnJvciA9PiB7XHJcbiAgICAgICAgICBjYWxsYmFjayhlcnJvciwgbnVsbCk7XHJcbiAgICAgICAgfSlcclxuICAgICAgfSk7XHJcbiAgfVxyXG5cclxuXHJcbiAgLyoqXHJcbiAgICogQGRlc2NyaXB0aW9uICBGZXRjaCBhIHJldmlldyBieSBpdHMgSUQuXHJcbiAgICogQGNvbnN0cnVjdG9yXHJcbiAgICogQHBhcmFtIHtpbnR9IGlkIC0gUmV2aWV3cyBpZGVudGlmaWVyLlxyXG4gICAqIEBwYXJhbSB7ZnVuY3Rpb259IGNhbGxiYWNrIC0gQ2FsbGJhY2sgZnVuY3Rpb24uXHJcbiAgICovXHJcbiAgIHN0YXRpYyBmZXRjaFJldmlld3NCeUlkKGlkLCBjYWxsYmFjaykge1xyXG4gICAgIGZldGNoKGAke0RCSGVscGVyLlJFVklFV1NfVVJMfS8ke2lkfWApXHJcbiAgICAgICAudGhlbihyZXNwb25zZSA9PiByZXNwb25zZS5qc29uKCkpXHJcbiAgICAgICAudGhlbihyZXZpZXcgPT4ge1xyXG4gICAgICAgICBEQkhlbHBlci5zdG9yZUluZGV4ZWREQihJREJfUkVWSUVXUywgcmV2aWV3KTtcclxuICAgICAgICAgY2FsbGJhY2sobnVsbCwgcmV2aWV3KVxyXG4gICAgICAgfSlcclxuICAgICAgIC5jYXRjaChlcnJvciA9PiB7XHJcbiAgICAgICAgIERCSGVscGVyLmdldFN0b3JlZE9iamVjdEJ5SWQoSURCX1JFVklFV1MsICdieS1pZCcsIGlkKVxyXG4gICAgICAgICAudGhlbigoc3RvcmVkUmV2aWV3KSA9PiB7XHJcbiAgICAgICAgICAgY2FsbGJhY2sobnVsbCwgc3RvcmVkUmV2aWV3KTtcclxuICAgICAgICAgfSkuY2F0Y2goZXJyb3IgPT4ge1xyXG4gICAgICAgICAgIGNhbGxiYWNrKGVycm9yLCBudWxsKTtcclxuICAgICAgICAgfSlcclxuICAgICAgIH0pO1xyXG4gICB9XHJcblxyXG5cclxuIC8qKlxyXG4gICogQGRlc2NyaXB0aW9uICBGZXRjaCBhbGwgcmVzdGF1cmFudCByZXZpZXdzIGJ5IHJlc3RhdXJhbnQgSUQuXHJcbiAgKiBAY29uc3RydWN0b3JcclxuICAqIEBwYXJhbSB7aW50fSBpZCAtIFJlc3RhdXJhbnQgaWRlbnRpZmllci5cclxuICAqIEBwYXJhbSB7ZnVuY3Rpb259IGNhbGxiYWNrIC0gQ2FsbGJhY2sgZnVuY3Rpb24uXHJcbiAgKi9cclxuICBzdGF0aWMgZmV0Y2hSZXZpZXdzQnlSZXN0SWQoaWQsIGNhbGxiYWNrKSB7XHJcbiAgICBmZXRjaChgJHtEQkhlbHBlci5SRVZJRVdTX1VSTH0vP3Jlc3RhdXJhbnRfaWQ9JHtpZH1gKVxyXG4gICAgICAudGhlbihyZXNwb25zZSA9PiByZXNwb25zZS5qc29uKCkpXHJcbiAgICAgIC50aGVuKHJldmlld3MgPT4ge1xyXG4gICAgICAgIERCSGVscGVyLnN0b3JlSW5kZXhlZERCKElEQl9SRVZJRVdTLCByZXZpZXdzKTtcclxuICAgICAgICBjYWxsYmFjayhudWxsLCByZXZpZXdzKVxyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goZXJyb3IgPT4ge1xyXG4gICAgICAgIERCSGVscGVyLmdldFN0b3JlZE9iamVjdEJ5SWQoSURCX1JFVklFV1MsICdieS1yZXN0YXVyYW50LWlkJywgaWQpXHJcbiAgICAgICAgLnRoZW4oKHN0b3JlZFJldmlld3MpID0+IHtcclxuICAgICAgICAgIGNhbGxiYWNrKG51bGwsIHN0b3JlZFJldmlld3MpO1xyXG4gICAgICAgIH0pLmNhdGNoKGVycm9yID0+IHtcclxuICAgICAgICAgIGNhbGxiYWNrKGVycm9yLCBudWxsKTtcclxuICAgICAgICB9KVxyXG4gICAgICB9KTtcclxuICB9XHJcblxyXG5cclxuICAvKipcclxuICAgKiBAZGVzY3JpcHRpb24gIFNlbmQgcmV2aWV3IHRvIHNlcnZlciBhbmQgc3RvcmVzIGl0IGF0IGRhdGFiYXNlLlxyXG4gICAqIEBjb25zdHJ1Y3RvclxyXG4gICAqIEBwYXJhbSB7b2JqZWN0fSByZXZpZXcgLSBSZXZpd2Ugb2JqZWN0LlxyXG4gICAqIEBwYXJhbSB7ZnVuY3Rpb259IGNhbGxiYWNrIC0gQ2FsbGJhY2sgZnVuY3Rpb24uXHJcbiAgICovXHJcbiAgc3RhdGljIHBvc3RSZXZpZXcocmV2aWV3LCBjYWxsYmFjaykge1xyXG4gICAgZmV0Y2goREJIZWxwZXIuUkVWSUVXU19VUkwsXHJcbiAgICAgIHtcclxuICAgICAgICBtZXRob2Q6J3Bvc3QnLFxyXG4gICAgICAgIGJvZHk6cmV2aWV3XHJcbiAgICAgIH0pXHJcbiAgICAgIC50aGVuKHJlc3BvbnNlID0+IHJlc3BvbnNlLmpzb24oKSlcclxuICAgICAgLnRoZW4ocmV2aWV3ID0+IHtcclxuICAgICAgICBEQkhlbHBlci5zdG9yZUluZGV4ZWREQihJREJfUkVWSUVXUywgcmV2aWV3KTtcclxuICAgICAgICBjYWxsYmFjayhudWxsLCByZXZpZXcpO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goZXJyb3IgPT4ge1xyXG4gICAgICAgIGNhbGxiYWNrKGVycm9yLCBudWxsKTtcclxuICAgICAgfSk7XHJcbiAgfVxyXG5cclxuXHJcbiAgLyoqXHJcbiAgICogQGRlc2NyaXB0aW9uICBTZW5kIHJlcXVlc3QgZmF2b3JpdGUvdW5mYXZvcml0ZSB0byBzZXJ2ZXIgYW5kIGNoYW5nZXMgYXQgZGF0YWJhc2UuXHJcbiAgICogQGNvbnN0cnVjdG9yXHJcbiAgICogQHBhcmFtIHtpbnR9IGlkIC0gUmVzdGF1cmFudCBpZGVudGlmaWVyLlxyXG4gICAqIEBwYXJhbSB7Ym9vbGVhbn0gZmF2b3JpdGUgLSBUcnVlIHRvIG1hcmsgYXMgZmF2b3JpdGUsIG90aGVyd2lzZSBmYWxzZS5cclxuICAgKiBAcGFyYW0ge2Z1bmN0aW9ufSBjYWxsYmFjayAtIENhbGxiYWNrIGZ1bmN0aW9uLlxyXG4gICAqL1xyXG4gIHN0YXRpYyBwdXRGYXZvcml0ZShpZCwgZmF2b3JpdGUsIGNhbGxiYWNrKSB7XHJcbiAgICBmZXRjaChgJHtEQkhlbHBlci5SRVNUQVVSQU5UU19VUkx9LyR7aWR9Lz9pc19mYXZvcml0ZT0ke2Zhdm9yaXRlfWAsXHJcbiAgICAgIHtcclxuICAgICAgICBtZXRob2Q6J3B1dCcsXHJcbiAgICAgICAgYm9keTpmYXZvcml0ZVxyXG4gICAgICB9KVxyXG4gICAgICAudGhlbihyZXNwb25zZSA9PiByZXNwb25zZS5qc29uKCkpXHJcbiAgICAgIC50aGVuKGZhdm9yaXRlID0+IHtcclxuICAgICAgICBEQkhlbHBlci5zdG9yZUluZGV4ZWREQihJREJfUkVTVEFVUkFOVFMsIGZhdm9yaXRlKTsgICAgICAgIFxyXG4gICAgICAgIGNhbGxiYWNrKG51bGwsIGZhdm9yaXRlKTtcclxuICAgICAgfSlcclxuICAgICAgLmNhdGNoKGVycm9yID0+IHtcclxuICAgICAgICBjYWxsYmFjayhlcnJvciwgbnVsbCk7XHJcbiAgICAgIH0pO1xyXG4gIH1cclxuXHJcblxyXG4gIC8qKlxyXG4gICAqIEBkZXNjcmlwdGlvbiAgU2VuZCByZXZpZXcgdG8gc2VydmVyIGFuZCBzdG9yZXMgaXQgYXQgZGF0YWJhc2UuXHJcbiAgICogQGNvbnN0cnVjdG9yXHJcbiAgICogQHBhcmFtIHtvYmplY3R9IHJldmlldyAtIFJldml3ZSBvYmplY3QuXHJcbiAgICogQHBhcmFtIHtmdW5jdGlvbn0gY2FsbGJhY2sgLSBDYWxsYmFjayBmdW5jdGlvbi5cclxuICAgKi9cclxuICBzdGF0aWMgcG9zdFJldmlldyhyZXZpZXcsIGNhbGxiYWNrKSB7XHJcbiAgICBmZXRjaChEQkhlbHBlci5SRVZJRVdTX1VSTCxcclxuICAgICAge1xyXG4gICAgICAgIG1ldGhvZDoncG9zdCcsXHJcbiAgICAgICAgYm9keTpyZXZpZXdcclxuICAgICAgfSlcclxuICAgICAgLnRoZW4ocmVzcG9uc2UgPT4gcmVzcG9uc2UuanNvbigpKVxyXG4gICAgICAudGhlbihyZXNwb25zZSA9PiB7XHJcbiAgICAgICAgY2FsbGJhY2sobnVsbCwgcmVzcG9uc2UpO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goZXJyb3IgPT4ge1xyXG4gICAgICAgIGNhbGxiYWNrKGVycm9yLCBudWxsKTtcclxuICAgICAgfSk7XHJcbiAgfVxyXG5cclxuXHJcbiAvKipcclxuICAqIEBkZXNjcmlwdGlvbiAgUmVzdGF1cmFudCBwYWdlIFVSTC5cclxuICAqIEBjb25zdHJ1Y3RvclxyXG4gICogQHBhcmFtIHtvYmplY3R9IHJlc3RhdXJhbnQgLSBSZXN0YXVyYW50IGluZm9ybWF0aW9uLlxyXG4gICovXHJcbiAgc3RhdGljIHVybEZvclJlc3RhdXJhbnQocmVzdGF1cmFudCkge1xyXG4gICAgcmV0dXJuIChgLi9yZXN0YXVyYW50Lmh0bWw/aWQ9JHtyZXN0YXVyYW50LmlkfWApO1xyXG4gIH1cclxuXHJcblxyXG4gLyoqXHJcbiAgKiBAZGVzY3JpcHRpb24gUmVzdGF1cmFudCBpbWFnZSBVUkwuXHJcbiAgKiBAY29uc3RydWN0b3JcclxuICAqIEBwYXJhbSB7b2JqZWN0fSByZXN0YXVyYW50IC0gUmVzdGF1cmFudCBpbmZvcm1hdGlvbi5cclxuICAqL1xyXG4gIHN0YXRpYyBpbWFnZVVybEZvclJlc3RhdXJhbnQocmVzdGF1cmFudCkge1xyXG4gICAgbGV0IHBob3RvZ3JhcGggPSAoJ3Bob3RvZ3JhcGgnIGluIHJlc3RhdXJhbnQpID8gcmVzdGF1cmFudC5waG90b2dyYXBoIDogcmVzdGF1cmFudC5pZDtcclxuICAgIHJldHVybiAoYC9kaXN0L2ltZy8ke3Bob3RvZ3JhcGh9YCk7XHJcbiAgfVxyXG5cclxuXHJcbiAvKipcclxuICAqIEBkZXNjcmlwdGlvbiBNYXAgbWFya2VyIGZvciBhIHJlc3RhdXJhbnQuXHJcbiAgKiBAY29uc3RydWN0b3JcclxuICAqIEBwYXJhbSB7b2JqZWN0fSByZXN0YXVyYW50IC0gUmVzdGF1cmFudCBjb29yZHMgYW5kIG5hbWUuXHJcbiAgKiBAcGFyYW0ge29iamVjdH0gbWFwIC0gR29vZ2xlIG1hcCBvYmplY3QuXHJcbiAgKi9cclxuICBzdGF0aWMgbWFwTWFya2VyRm9yUmVzdGF1cmFudChyZXN0YXVyYW50LCBtYXApIHtcclxuICAgIGNvbnN0IG1hcmtlciA9IG5ldyBnb29nbGUubWFwcy5NYXJrZXIoe1xyXG4gICAgICBwb3NpdGlvbjogcmVzdGF1cmFudC5sYXRsbmcsXHJcbiAgICAgIHRpdGxlOiByZXN0YXVyYW50Lm5hbWUsXHJcbiAgICAgIHVybDogREJIZWxwZXIudXJsRm9yUmVzdGF1cmFudChyZXN0YXVyYW50KSxcclxuICAgICAgbWFwOiBtYXAsXHJcbiAgICAgIGFuaW1hdGlvbjogZ29vZ2xlLm1hcHMuQW5pbWF0aW9uLkRST1B9XHJcbiAgICApO1xyXG4gICAgcmV0dXJuIG1hcmtlcjtcclxuICB9XHJcblxyXG5cclxuIC8qKlxyXG4gICogQGRlc2NyaXB0aW9uIFJlZ2lzdGVyIFNlcnZpY2VXb3JrZXIuXHJcbiAgKiBAY29uc3RydWN0b3JcclxuICAqL1xyXG4gIHN0YXRpYyByZWdpc3RlclNlcnZpY2VXb3JrZXIoKSB7XHJcbiAgICBpZiAoJ3NlcnZpY2VXb3JrZXInIGluIG5hdmlnYXRvcikge1xyXG4gICAgICBuYXZpZ2F0b3Iuc2VydmljZVdvcmtlci5yZWdpc3Rlcignc3cuanMnKVxyXG4gICAgICAgIC50aGVuKChyZWcpID0+IHtcclxuICAgICAgICAgIGNvbnNvbGUubG9nKGBTZXJ2aWNlIFdvcmtlciByZWdpc3RyYXRpb24gc3VjY2Vzc2Z1bC4gSXRzIHNjb3BlIGlzICR7cmVnLnNjb3BlfSBgKTtcclxuICAgICAgICB9KS5jYXRjaCgoZXJyb3IpID0+IHtcclxuICAgICAgICAgIGNvbnNvbGUubG9nKGBTZXJ2aWNlIFdvcmtlciByZWdpc3RyYXRpb24gZXJyb3I6ICR7ZXJyb3J9YCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcbm1vZHVsZS5leHBvcnRzID0gREJIZWxwZXI7XHJcbiIsImNvbnN0IERCSGVscGVyID0gcmVxdWlyZSgnLi9kYmhlbHBlcicpO1xyXG5sZXQgcmVzdGF1cmFudHMsXHJcbiAgbmVpZ2hib3Job29kcyxcclxuICBjdWlzaW5lcztcclxubGV0IG1hcDtcclxubGV0IG1hcmtlcnMgPSBbXTtcclxubGV0IHN0YXRpY01hcCA9IGZhbHNlO1xyXG5sZXQgaXNfZmF2b3JpdGU7XHJcblxyXG4vKipcclxuICAqIEBkZXNjcmlwdGlvbiBDYWxsIGZ1bmN0aW9ucyB3aGVuIERPTSBjb250ZW50IGlzIGxvYWRlZFxyXG4gICogQGNvbnN0cnVjdG9yXHJcbiAgKiBAcGFyYW0ge3N0cmluZ30gRE9NQ29udGVudExvYWRlZCAtIFN0cmluZyBkZXRlY3RlZC5cclxuICAqIEBwYXJhbSB7ZXZlbnR9IGV2ZW50IC0gRXZlbnQgY2FsbGVkXHJcbiAgKi9cclxuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIChldmVudCkgPT4ge1xyXG4gIERCSGVscGVyLnJlZ2lzdGVyU2VydmljZVdvcmtlcigpO1xyXG4gIERCSGVscGVyLm9wZW5JbmRleGVkREIoKTtcclxuICBmZXRjaE5laWdoYm9yaG9vZHMoKTtcclxuICBmZXRjaEN1aXNpbmVzKCk7XHJcbn0pO1xyXG5cclxuXHJcbi8qKlxyXG4gICogQGRlc2NyaXB0aW9uIENhbGwgZnVuY3Rpb25zIHdoZW4gd2luZG93IGlzIHJlc2l6ZWRcclxuICAqIEBjb25zdHJ1Y3RvclxyXG4gICogQHBhcmFtIHtzdHJpbmd9IHJlc2l6ZSAtIFN0cmluZyBkZXRlY3RlZC5cclxuICAqIEBwYXJhbSB7ZXZlbnR9IGV2ZW50IC0gRXZlbnQgY2FsbGVkXHJcbiAgKi9cclxud2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIChldmVudCkgPT57XHJcbiAgaW5pdE1hcCgpO1xyXG59KTtcclxuXHJcblxyXG4vKipcclxuICogQGRlc2NyaXB0aW9uICBGZXRjaCBhbGwgbmVpZ2hib3Job29kcyBhbmQgc2V0IHRoZWlyIEhUTUwuXHJcbiAqIEBjb25zdHJ1Y3RvclxyXG4gKiBAcGFyYW0ge29iamVjdH0gZXJyb3IgLSBlcnJvciBvYmplY3QuXHJcbiAqIEBwYXJhbSB7b2JqZWN0fSBuZWlnaGJvcmhvb2RzIC0gbmVpZ2hib3Job29kIGxpc3QuXHJcbiAqL1xyXG5mZXRjaE5laWdoYm9yaG9vZHMgPSAoKSA9PiB7XHJcbiAgREJIZWxwZXIuZmV0Y2hOZWlnaGJvcmhvb2RzKChlcnJvciwgbmVpZ2hib3Job29kcykgPT4ge1xyXG4gICAgaWYgKGVycm9yKSB7IC8vIEdvdCBhbiBlcnJvclxyXG4gICAgICBjb25zb2xlLmVycm9yKGVycm9yKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHNlbGYubmVpZ2hib3Job29kcyA9IG5laWdoYm9yaG9vZHM7XHJcbiAgICAgIGZpbGxOZWlnaGJvcmhvb2RzSFRNTCgpO1xyXG4gICAgfVxyXG4gIH0pO1xyXG59XHJcblxyXG5cclxuLyoqXHJcbiogQGRlc2NyaXB0aW9uICBTZXQgbmVpZ2hib3Job29kcyBIVE1MLlxyXG4qIEBjb25zdHJ1Y3RvclxyXG4qIEBwYXJhbSB7b2JqZWN0fSBuZWlnaGJvcmhvb2RzIC0gbmVpZ2hib3Job29kIGxpc3QuXHJcbiovXHJcbmZpbGxOZWlnaGJvcmhvb2RzSFRNTCA9IChuZWlnaGJvcmhvb2RzID0gc2VsZi5uZWlnaGJvcmhvb2RzKSA9PiB7XHJcbiAgY29uc3Qgc2VsZWN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ25laWdoYm9yaG9vZHMtc2VsZWN0Jyk7XHJcbiAgbmVpZ2hib3Job29kcy5mb3JFYWNoKG5laWdoYm9yaG9vZCA9PiB7XHJcbiAgICBjb25zdCBvcHRpb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdvcHRpb24nKTtcclxuICAgIG9wdGlvbi5pbm5lckhUTUwgPSBuZWlnaGJvcmhvb2Q7XHJcbiAgICBvcHRpb24udmFsdWUgPSBuZWlnaGJvcmhvb2Q7XHJcbiAgICBzZWxlY3QuYXBwZW5kKG9wdGlvbik7XHJcbiAgfSk7XHJcbn1cclxuXHJcblxyXG4vKipcclxuKiBAZGVzY3JpcHRpb24gIGZldGNoIGFsbCBjdWlzaW5lcyBhbmQgc2V0IHRoZWlyIEhUTUwuXHJcbiogQGNvbnN0cnVjdG9yXHJcbiogQHBhcmFtIHtvYmplY3R9IGVycm9yIC0gZXJyb3Igb2JqZWN0LlxyXG4qIEBwYXJhbSB7b2JqZWN0fSBjdWlzaW5lcyAtIGN1aXNpbmVzIGxpc3QuXHJcbiovXHJcbmZldGNoQ3Vpc2luZXMgPSAoKSA9PiB7XHJcbiAgREJIZWxwZXIuZmV0Y2hDdWlzaW5lcygoZXJyb3IsIGN1aXNpbmVzKSA9PiB7XHJcbiAgICBpZiAoZXJyb3IpIHsgLy8gR290IGFuIGVycm9yIVxyXG4gICAgICBjb25zb2xlLmVycm9yKGVycm9yKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHNlbGYuY3Vpc2luZXMgPSBjdWlzaW5lcztcclxuICAgICAgZmlsbEN1aXNpbmVzSFRNTCgpO1xyXG4gICAgfVxyXG4gIH0pO1xyXG59XHJcblxyXG5cclxuLyoqXHJcbiogQGRlc2NyaXB0aW9uICBTZXQgY3Vpc2luZXMgSFRNTC5cclxuKiBAY29uc3RydWN0b3JcclxuKiBAcGFyYW0ge29iamVjdH0gY3Vpc2luZXMgLSBjdWlzaW5lcyBsaXN0LlxyXG4qL1xyXG5maWxsQ3Vpc2luZXNIVE1MID0gKGN1aXNpbmVzID0gc2VsZi5jdWlzaW5lcykgPT4ge1xyXG4gIGNvbnN0IHNlbGVjdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjdWlzaW5lcy1zZWxlY3QnKTtcclxuXHJcbiAgY3Vpc2luZXMuZm9yRWFjaChjdWlzaW5lID0+IHtcclxuICAgIGNvbnN0IG9wdGlvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ29wdGlvbicpO1xyXG4gICAgb3B0aW9uLmlubmVySFRNTCA9IGN1aXNpbmU7XHJcbiAgICBvcHRpb24udmFsdWUgPSBjdWlzaW5lO1xyXG4gICAgc2VsZWN0LmFwcGVuZChvcHRpb24pO1xyXG4gIH0pO1xyXG59XHJcblxyXG5cclxuLyoqXHJcbiogQGRlc2NyaXB0aW9uICBVcGRhdGUgcGFnZSBhbmQgbWFwIGZvciBjdXJyZW50IHJlc3RhdXJhbnRzLlxyXG4qIEBjb25zdHJ1Y3RvclxyXG4qL1xyXG51cGRhdGVSZXN0YXVyYW50cyA9ICgpID0+IHtcclxuICBjb25zdCBjU2VsZWN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2N1aXNpbmVzLXNlbGVjdCcpO1xyXG4gIGNvbnN0IG5TZWxlY3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmVpZ2hib3Job29kcy1zZWxlY3QnKTtcclxuXHJcbiAgY29uc3QgY0luZGV4ID0gY1NlbGVjdC5zZWxlY3RlZEluZGV4O1xyXG4gIGNvbnN0IG5JbmRleCA9IG5TZWxlY3Quc2VsZWN0ZWRJbmRleDtcclxuXHJcbiAgY29uc3QgY3Vpc2luZSA9IGNTZWxlY3RbY0luZGV4XS52YWx1ZTtcclxuICBjb25zdCBuZWlnaGJvcmhvb2QgPSBuU2VsZWN0W25JbmRleF0udmFsdWU7XHJcblxyXG4gIERCSGVscGVyLmZldGNoUmVzdGF1cmFudEJ5Q3Vpc2luZUFuZE5laWdoYm9yaG9vZChjdWlzaW5lLCBuZWlnaGJvcmhvb2QsIChlcnJvciwgcmVzdGF1cmFudHMpID0+IHtcclxuICAgIGlmIChlcnJvcikgeyAvLyBHb3QgYW4gZXJyb3IhXHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgcmVzZXRSZXN0YXVyYW50cyhyZXN0YXVyYW50cyk7XHJcbiAgICAgIGZpbGxSZXN0YXVyYW50c0hUTUwoKTtcclxuICAgIH1cclxuICB9KVxyXG59XHJcblxyXG5cclxuLyoqXHJcbiogQGRlc2NyaXB0aW9uICBDbGVhciBjdXJyZW50IHJlc3RhdXJhbnRzLCB0aGVpciBIVE1MIGFuZCByZW1vdmUgdGhlaXIgbWFwIG1hcmtlcnMuXHJcbiogQGNvbnN0cnVjdG9yXHJcbiogQHBhcmFtIHtvYmplY3R9IHJlc3RhdXJhbnRzIC0gcmVzdGF1cmFudHMgbGlzdC5cclxuKi9cclxucmVzZXRSZXN0YXVyYW50cyA9IChyZXN0YXVyYW50cykgPT4ge1xyXG4gIC8vIFJlbW92ZSBhbGwgcmVzdGF1cmFudHNcclxuICBzZWxmLnJlc3RhdXJhbnRzID0gW107XHJcbiAgY29uc3QgdWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdGF1cmFudHMtbGlzdCcpO1xyXG4gIHVsLmlubmVySFRNTCA9ICcnO1xyXG5cclxuICAvLyBSZW1vdmUgYWxsIG1hcCBtYXJrZXJzXHJcbiAgaWYoc2VsZi5tYXJrZXJzICE9PSB1bmRlZmluZWQpIHtcclxuICAgIHNlbGYubWFya2Vycy5mb3JFYWNoKG0gPT4gbS5zZXRNYXAobnVsbCkpO1xyXG4gIH1cclxuICBzZWxmLm1hcmtlcnMgPSBbXTtcclxuICBzZWxmLnJlc3RhdXJhbnRzID0gcmVzdGF1cmFudHM7XHJcblxyXG59XHJcblxyXG5cclxuLyoqXHJcbiogQGRlc2NyaXB0aW9uIENyZWF0ZSBhbGwgcmVzdGF1cmFudHMgSFRNTCBhbmQgYWRkIHRoZW0gdG8gdGhlIHdlYnBhZ2UuXHJcbiogQGNvbnN0cnVjdG9yXHJcbiogQHBhcmFtIHtvYmplY3R9IHJlc3RhdXJhbnRzIC0gcmVzdGF1cmFudHMgY3JlYXRlZC5cclxuKi9cclxuZmlsbFJlc3RhdXJhbnRzSFRNTCA9IChyZXN0YXVyYW50cyA9IHNlbGYucmVzdGF1cmFudHMpID0+IHtcclxuICBjb25zdCB1bCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN0YXVyYW50cy1saXN0Jyk7XHJcbiAgcmVzdGF1cmFudHMuZm9yRWFjaChyZXN0YXVyYW50ID0+IHtcclxuICAgIHVsLmFwcGVuZChjcmVhdGVSZXN0YXVyYW50SFRNTChyZXN0YXVyYW50KSk7XHJcbiAgfSk7XHJcbiAgYWRkTWFya2Vyc1RvTWFwKCk7XHJcbn1cclxuXHJcblxyXG4vKipcclxuKiBAZGVzY3JpcHRpb24gQ3JlYXRlIHJlc3RhdXJhbnQgSFRNTC5cclxuKiBAY29uc3RydWN0b3JcclxuKiBAcGFyYW0ge29iamVjdH0gcmVzdGF1cmFudCAtIHJlc3RhdXJhbnRzIG9iamVjdC5cclxuKi9cclxuY3JlYXRlUmVzdGF1cmFudEhUTUwgPSAocmVzdGF1cmFudCkgPT4ge1xyXG4gIGNvbnN0IGxpID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGknKTtcclxuXHJcbiAgY29uc3QgaW1nID0gREJIZWxwZXIuaW1hZ2VVcmxGb3JSZXN0YXVyYW50KHJlc3RhdXJhbnQpO1xyXG4gIGNvbnN0IHBpY3R1cmUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwaWN0dXJlJyk7XHJcbiAgcGljdHVyZS5jbGFzc05hbWUgPSAncmVzdGF1cmFudC1pbWcnO1xyXG4gIHBpY3R1cmUuc2V0QXR0cmlidXRlKCdhcmlhLWxhYmVsbGVkYnknLCBgcGljdHVyZV8ke3Jlc3RhdXJhbnQuaWR9YCk7XHJcbiAgcGljdHVyZS5zZXRBdHRyaWJ1dGUoJ3JvbGUnLCAnaW1nJyk7XHJcblxyXG4gIGNvbnN0IHNvdXJjZVNtYWxsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc291cmNlJyk7XHJcbiAgc291cmNlU21hbGwuc2V0QXR0cmlidXRlKCdtZWRpYScsICcobWF4LXdpZHRoOjQ4MHB4KScpO1xyXG4gIHNvdXJjZVNtYWxsLnNldEF0dHJpYnV0ZSgnc3Jjc2V0JywgYCR7aW1nfS0zODBfc21hbGwuanBnYCk7XHJcbiAgcGljdHVyZS5hcHBlbmQoc291cmNlU21hbGwpO1xyXG5cclxuICBjb25zdCBzb3VyY2VNZWRpdW0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzb3VyY2UnKTtcclxuICBzb3VyY2VNZWRpdW0uc2V0QXR0cmlidXRlKCdtZWRpYScsICcobWluLXdpZHRoOiA0ODBweCkgYW5kIChtYXgtd2lkdGg6IDk2MHB4KScpO1xyXG4gIHNvdXJjZU1lZGl1bS5zZXRBdHRyaWJ1dGUoJ3NyY3NldCcsIGAke2ltZ30tNTEyX21lZGl1bS5qcGdgKTtcclxuICBwaWN0dXJlLmFwcGVuZChzb3VyY2VNZWRpdW0pO1xyXG5cclxuICBjb25zdCBzb3VyY2VMYXJnZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NvdXJjZScpO1xyXG4gIHNvdXJjZUxhcmdlLnNldEF0dHJpYnV0ZSgnbWVkaWEnLCAnKG1pbi13aWR0aDo5NjFweCknKTtcclxuICBzb3VyY2VMYXJnZS5zZXRBdHRyaWJ1dGUoJ3NyY3NldCcsIGAke2ltZ30tODAwX2xhcmdlLmpwZ2ApO1xyXG4gIHBpY3R1cmUuYXBwZW5kKHNvdXJjZUxhcmdlKTtcclxuXHJcbiAgY29uc3QgaW1hZ2UgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbWcnKTtcclxuICBpbWFnZS5pZCA9IGBwaWN0dXJlXyR7cmVzdGF1cmFudC5pZH1gO1xyXG4gIGltYWdlLmNsYXNzTmFtZSA9ICdyZXN0YXVyYW50LWltZyc7XHJcbiAgaW1hZ2UuYWx0ID0gYFBpY3R1cmUgb2YgJHtyZXN0YXVyYW50Lm5hbWV9IHJlc3RhdXJhbnRgO1xyXG4gIGltYWdlLnNyYyA9IGAke2ltZ30tMzgwX3NtYWxsLmpwZ2A7XHJcblxyXG4gIHBpY3R1cmUuYXBwZW5kKGltYWdlKTtcclxuXHJcbiAgbGkuYXBwZW5kKHBpY3R1cmUpO1xyXG5cclxuXHJcbiAgY29uc3QgbmFtZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2gyJyk7XHJcbiAgbmFtZS5pbm5lckhUTUwgPSByZXN0YXVyYW50Lm5hbWU7XHJcbiAgbGkuYXBwZW5kKG5hbWUpO1xyXG5cclxuICBjb25zdCBuZWlnaGJvcmhvb2QgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XHJcbiAgbmVpZ2hib3Job29kLmlubmVySFRNTCA9IHJlc3RhdXJhbnQubmVpZ2hib3Job29kO1xyXG4gIGxpLmFwcGVuZChuZWlnaGJvcmhvb2QpO1xyXG5cclxuICBjb25zdCBmYXZvcml0ZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gIGZhdm9yaXRlLmNsYXNzTmFtZSA9ICdmYXYnO1xyXG4gIGNvbnN0IGxpbmsgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7XHJcbiAgbGluay5jbGFzc05hbWUgPSAnZmF2b3JpdGUnO1xyXG4gIGxpbmsuc2V0QXR0cmlidXRlKCdyb2xlJywgJ2J1dHRvbicpO1xyXG4gIGxpbmsuc2V0QXR0cmlidXRlKCd0YWJpbmRleCcsICcwJyk7XHJcbiAgZXZlbnRMaXN0ZW5lckZhdm9yaXRlKGxpbmssIHJlc3RhdXJhbnQuaWQpO1xyXG5cclxuICBjb25zdCBzdmcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJywgJ3N2ZycpO1xyXG4gIHN2Zy5zZXRBdHRyaWJ1dGUoJ2NsYXNzJywnc3ZnLWZhdicpO1xyXG4gIHN2Zy5zZXRBdHRyaWJ1dGUoJ3ZpZXdCb3gnLCcwIDAgNTc2IDUxMicpO1xyXG4gIHN2Zy5zZXRBdHRyaWJ1dGUoJ2FyaWEtbGFiZWxsZWRieScsIGB0aXRsZS0ke3Jlc3RhdXJhbnQuaWR9IGRlc2NyaXB0aW9uLSR7cmVzdGF1cmFudC5pZH1gKTtcclxuXHJcbiAgY29uc3QgdGl0bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJywgXCJ0aXRsZVwiKTtcclxuICB0aXRsZS5zZXRBdHRyaWJ1dGUoJ2lkJywgYHRpdGxlLSR7cmVzdGF1cmFudC5pZH1gKTtcclxuXHJcbiAgY29uc3QgZGVzYyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCBcImRlc2NcIik7XHJcbiAgZGVzYy5zZXRBdHRyaWJ1dGUoJ2lkJywgYGRlc2NyaXB0aW9uLSR7cmVzdGF1cmFudC5pZH1gKTtcclxuICBkZXNjLmlubmVySFRNTCA9ICdGYXZvcml0ZSBpbWFnZSc7XHJcblxyXG4gIGNvbnN0IHBhdGggPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJywgJ3BhdGgnKTtcclxuICBwYXRoLnNldEF0dHJpYnV0ZSgnY2xhc3MnLCdwYXRoLWZhdicpO1xyXG4gIHBhdGguc2V0QXR0cmlidXRlKCdyb2xlJywncHJlc2VudGF0aW9uJyk7XHJcblxyXG4gIHNlbGYuaXNfZmF2b3JpdGUgPSAocmVzdGF1cmFudC5pc19mYXZvcml0ZSA9PSAndHJ1ZScpID8gdHJ1ZSA6IGZhbHNlO1xyXG4gIGlmKCBzZWxmLmlzX2Zhdm9yaXRlICkge1xyXG4gICAgbGluay50aXRsZSA9ICdSZW1vdmUgZmF2b3JpdGUnO1xyXG4gICAgbGluay5zZXRBdHRyaWJ1dGUoJ2FyaWEtbGFiZWwnLCAnUmVtb3ZlIGZhdm9yaXRlJyk7XHJcbiAgICBsaW5rLmRhdGFzZXQuZmF2b3JpdGUgPSAncmVtb3ZlJztcclxuICAgIHRpdGxlLmlubmVySFRNTCA9ICdSZW1vdmUgZmF2b3JpdGUnO1xyXG4gICAgcGF0aC5zZXRBdHRyaWJ1dGUoXCJkXCIsXCJNMjU5LjMgMTcuOEwxOTQgMTUwLjIgNDcuOSAxNzEuNWMtMjYuMiAzLjgtMzYuNyAzNi4xLTE3LjcgNTQuNmwxMDUuNyAxMDMtMjUgMTQ1LjVjLTQuNSAyNi4zIDIzLjIgNDYgNDYuNCAzMy43TDI4OCA0MzkuNmwxMzAuNyA2OC43YzIzLjIgMTIuMiA1MC45LTcuNCA0Ni40LTMzLjdsLTI1LTE0NS41IDEwNS43LTEwM2MxOS0xOC41IDguNS01MC44LTE3LjctNTQuNkwzODIgMTUwLjIgMzE2LjcgMTcuOGMtMTEuNy0yMy42LTQ1LjYtMjMuOS01Ny40IDB6XCIpO1xyXG4gIH0gZWxzZSB7XHJcbiAgICBsaW5rLnRpdGxlID0gJ0FkZCB0byBmYXZvcml0ZSc7XHJcbiAgICBsaW5rLnNldEF0dHJpYnV0ZSgnYXJpYS1sYWJlbCcsICdBZGQgdG8gZmF2b3JpdGUnKTtcclxuICAgIGxpbmsuZGF0YXNldC5mYXZvcml0ZSA9ICdhZGQnO1xyXG4gICAgdGl0bGUuaW5uZXJIVE1MID0gJ0FkZCB0byBmYXZvcml0ZSc7XHJcbiAgICBwYXRoLnNldEF0dHJpYnV0ZShcImRcIixcIk01MjguMSAxNzEuNUwzODIgMTUwLjIgMzE2LjcgMTcuOGMtMTEuNy0yMy42LTQ1LjYtMjMuOS01Ny40IDBMMTk0IDE1MC4yIDQ3LjkgMTcxLjVjLTI2LjIgMy44LTM2LjcgMzYuMS0xNy43IDU0LjZsMTA1LjcgMTAzLTI1IDE0NS41Yy00LjUgMjYuMyAyMy4yIDQ2IDQ2LjQgMzMuN0wyODggNDM5LjZsMTMwLjcgNjguN2MyMy4yIDEyLjIgNTAuOS03LjQgNDYuNC0zMy43bC0yNS0xNDUuNSAxMDUuNy0xMDNjMTktMTguNSA4LjUtNTAuOC0xNy43LTU0LjZ6TTM4OC42IDMxMi4zbDIzLjcgMTM4LjRMMjg4IDM4NS40bC0xMjQuMyA2NS4zIDIzLjctMTM4LjQtMTAwLjYtOTggMTM5LTIwLjIgNjIuMi0xMjYgNjIuMiAxMjYgMTM5IDIwLjItMTAwLjYgOTh6XCIpO1xyXG4gIH1cclxuXHJcbiAgc3ZnLmFwcGVuZENoaWxkKHRpdGxlKTtcclxuICBzdmcuYXBwZW5kQ2hpbGQoZGVzYyk7XHJcbiAgc3ZnLmFwcGVuZENoaWxkKHBhdGgpO1xyXG4gIGxpbmsuYXBwZW5kKHN2Zyk7XHJcbiAgZmF2b3JpdGUuYXBwZW5kKGxpbmspO1xyXG4gIGxpLmFwcGVuZChmYXZvcml0ZSk7XHJcblxyXG4gIGNvbnN0IGFkZHJlc3MgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XHJcbiAgYWRkcmVzcy5pbm5lckhUTUwgPSByZXN0YXVyYW50LmFkZHJlc3M7XHJcbiAgbGkuYXBwZW5kKGFkZHJlc3MpO1xyXG5cclxuICBjb25zdCBtb3JlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpO1xyXG4gIG1vcmUuaW5uZXJIVE1MID0gJ1ZpZXcgRGV0YWlscyc7XHJcbiAgbW9yZS5zZXRBdHRyaWJ1dGUoJ2NsYXNzJywgJ2RldGFpbHMnKTtcclxuICBtb3JlLmhyZWYgPSBEQkhlbHBlci51cmxGb3JSZXN0YXVyYW50KHJlc3RhdXJhbnQpO1xyXG4gIGxpLmFwcGVuZChtb3JlKVxyXG5cclxuICByZXR1cm4gbGlcclxufVxyXG5cclxuXHJcbi8qKlxyXG4qIEBkZXNjcmlwdGlvbiAgRGVwZW5kcyBvZiByZXNvbHV0aW9ucyBpbml0YWxpemUgaW1hZ2UgbWFwIG9yIGdvb2dsZSBtYXAuXHJcbiogQGNvbnN0cnVjdG9yXHJcbiovXHJcbndpbmRvdy5pbml0TWFwID0gKCkgPT4ge1xyXG4gIGlmKHdpbmRvdy5pbm5lcldpZHRoIDwgNjQxKSB7XHJcbiAgICB2YXIgZ29vZ2xlTWFwID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21hcCcpO1xyXG4gICAgZ29vZ2xlTWFwLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XHJcbiAgICBkaXNwbGF5U3RhdGljTWFwKCk7XHJcbiAgICBzZWxmLnN0YXRpY01hcCA9IHRydWU7XHJcbiAgfSBlbHNlIHtcclxuICAgIHZhciBpbWFnZU1hcCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzdGF0aWMtbWFwJyk7XHJcbiAgICBpbWFnZU1hcC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xyXG4gICAgZGlzcGxheU1hcCgpO1xyXG4gICAgc2VsZi5zdGF0aWNNYXAgPSBmYWxzZTtcclxuICB9XHJcbn1cclxuXHJcblxyXG4vKipcclxuKiBAZGVzY3JpcHRpb24gIEluaXRpYWxpemUgR29vZ2xlIG1hcCwgY2FsbGVkIGZyb20gSFRNTC5cclxuKiBAY29uc3RydWN0b3JcclxuKi9cclxuZGlzcGxheU1hcCA9ICgpID0+IHtcclxuICBpZihzZWxmLnN0YXRpY01hcCA9PT0gZmFsc2UpIHtcclxuICAgIHJldHVybjtcclxuICB9XHJcbiAgbGV0IGdvb2dsZU1hcCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYXAnKTtcclxuICBnb29nbGVNYXAuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XHJcbiAgc2VsZi5zdGF0aWNNYXAgPSBmYWxzZTtcclxuXHJcbiAgbGV0IGxvYyA9IHtcclxuICAgIGxhdDogNDAuNzIyMjE2LFxyXG4gICAgbG5nOiAtNzMuOTg3NTAxXHJcbiAgfVxyXG4gIHNlbGYubWFwID0gbmV3IGdvb2dsZS5tYXBzLk1hcChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFwJyksIHtcclxuICAgIHpvb206IDEyLFxyXG4gICAgY2VudGVyOiBsb2MsXHJcbiAgICBzY3JvbGx3aGVlbDogZmFsc2VcclxuICB9KTtcclxuICB1cGRhdGVSZXN0YXVyYW50cygpO1xyXG59XHJcblxyXG5cclxuLyoqXHJcbiogQGRlc2NyaXB0aW9uICBEaXNwbGF5IFN0YXRpYyBtYXAgYXQgTW9iaWxlIHJlc29sdXRpb25zLlxyXG4qIEBjb25zdHJ1Y3RvclxyXG4qL1xyXG5kaXNwbGF5U3RhdGljTWFwID0gKCkgPT4ge1xyXG4gIGlmKHNlbGYuc3RhdGljTWFwID09PSB0cnVlKSB7XHJcbiAgICByZXR1cm47XHJcbiAgfVxyXG5cclxuICBsZXQgaW1hZ2VNYXAgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc3RhdGljLW1hcCcpO1xyXG4gIGltYWdlTWFwLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xyXG5cclxuICBpbWFnZU1hcC5zZXRBdHRyaWJ1dGUoJ3NyYycsYGh0dHBzOi8vbWFwcy5nb29nbGVhcGlzLmNvbS9tYXBzL2FwaS9zdGF0aWNtYXA/Y2VudGVyPTQwLjcyMjIxNiwtNzMuOTg3NTAxJnpvb209MTImc2l6ZT0ke3dpbmRvdy5pbm5lcldpZHRofXg0MDAmZm9ybWF0PWpwZyZtYXB0eXBlPXJvYWRtYXAmbWFya2Vycz1jb2xvcjpyZWRgKTtcclxuICBzZWxmLnN0YXRpY01hcCA9IHRydWU7XHJcblxyXG4gIGltYWdlTWFwLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJyxmdW5jdGlvbihlKSB7XHJcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICBpbWFnZU1hcC5zdHlsZS5kaXNwbGF5ID0nbm9uZSc7XHJcbiAgICBkaXNwbGF5TWFwKCk7XHJcbiAgfSk7XHJcbn1cclxuXHJcblxyXG4vKipcclxuKiBAZGVzY3JpcHRpb24gQWRkIG1hcmtlcnMgZm9yIGN1cnJlbnQgcmVzdGF1cmFudHMgdG8gdGhlIG1hcC5cclxuKiBAY29uc3RydWN0b3JcclxuKiBAcGFyYW0ge29iamVjdH0gcmVzdGF1cmFudHMgLSByZXN0YXVyYW50cyBsaXN0LlxyXG4qL1xyXG5hZGRNYXJrZXJzVG9NYXAgPSAocmVzdGF1cmFudHMgPSBzZWxmLnJlc3RhdXJhbnRzKSA9PiB7XHJcbiAgcmVzdGF1cmFudHMuZm9yRWFjaChyZXN0YXVyYW50ID0+IHtcclxuICAgIC8vIEFkZCBtYXJrZXIgdG8gdGhlIG1hcFxyXG4gICAgY29uc3QgbWFya2VyID0gREJIZWxwZXIubWFwTWFya2VyRm9yUmVzdGF1cmFudChyZXN0YXVyYW50LCBzZWxmLm1hcCk7XHJcbiAgICBnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lcihtYXJrZXIsICdjbGljaycsICgpID0+IHtcclxuICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSBtYXJrZXIudXJsXHJcbiAgICB9KTtcclxuICAgIHNlbGYubWFya2Vycy5wdXNoKG1hcmtlcik7XHJcbiAgfSk7XHJcbn1cclxuXHJcblxyXG4vKipcclxuICogQGRlc2NyaXB0aW9uIENhbGxzIGNsaWNrIGV2ZW50IG9mIGZhdm9yaXRlL3VuZmF2b3JpdGUgYnV0dG9uLlxyXG4gKiBAY29uc3RydWN0b3JcclxuICogQHBhcmFtIHtpbnRlZ2VyfSBpZCAtIHJlc3RhdXJhbnQgaWRlbnRpZmllci5cclxuICogQHBhcmFtIHtvYmplY3R9IGxpbmsgIC0gTGluayB0byBhZGQgdGhlIGV2ZW50IGxpc3RlbmVyLlxyXG4gKi9cclxuIGV2ZW50TGlzdGVuZXJGYXZvcml0ZSA9IChsaW5rLCBpZCkgPT4ge1xyXG4gICBsaW5rLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oZSkge1xyXG4gICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgc2VsZi5pc19mYXZvcml0ZSA9ICh0aGlzLmRhdGFzZXQuZmF2b3JpdGUgPT0gJ2FkZCcpID8gdHJ1ZSA6IGZhbHNlO1xyXG4gICAgIERCSGVscGVyLnB1dEZhdm9yaXRlKGlkLCBzZWxmLmlzX2Zhdm9yaXRlLCAoZXJyb3IsIHJlc3VsdCkgPT4ge1xyXG4gICAgICAgaWYgKCFyZXN1bHQpIHtcclxuICAgICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7XHJcbiAgICAgICAgIHJldHVybjtcclxuICAgICAgIH1cclxuICAgICAgIHNlbGYucmVzdGF1cmFudHMuZm9yRWFjaChyZXN0YXVyYW50ID0+IHtcclxuICAgICAgICAgaWYoIHJlc3RhdXJhbnQuaWQgPT0gaWQgKSB7XHJcbiAgICAgICAgICAgcmVzdGF1cmFudC5pc19mYXZvcml0ZSA9IHNlbGYuaXNfZmF2b3JpdGUgPyAndHJ1ZScgOiAnZmFsc2UnO1xyXG4gICAgICAgICB9XHJcbiAgICAgICB9KTtcclxuXHJcbiAgICAgICBpZiggc2VsZi5pc19mYXZvcml0ZSApIHtcclxuICAgICAgICAgbGluay50aXRsZSA9ICdSZW1vdmUgZmF2b3JpdGUnO1xyXG4gICAgICAgICBsaW5rLnNldEF0dHJpYnV0ZSgnYXJpYS1sYWJlbCcsICdSZW1vdmUgZmF2b3JpdGUnKTtcclxuICAgICAgICAgbGluay5kYXRhc2V0LmZhdm9yaXRlID0gJ3JlbW92ZSc7XHJcbiAgICAgICAgIGxpbmsuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ3RpdGxlJylbMF0uaW5uZXJIVE1MID0gJ1JlbW92ZSBmYXZvcml0ZSc7XHJcbiAgICAgICAgIGxpbmsuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ3BhdGgnKVswXS5zZXRBdHRyaWJ1dGUoXCJkXCIsXCJNMjU5LjMgMTcuOEwxOTQgMTUwLjIgNDcuOSAxNzEuNWMtMjYuMiAzLjgtMzYuNyAzNi4xLTE3LjcgNTQuNmwxMDUuNyAxMDMtMjUgMTQ1LjVjLTQuNSAyNi4zIDIzLjIgNDYgNDYuNCAzMy43TDI4OCA0MzkuNmwxMzAuNyA2OC43YzIzLjIgMTIuMiA1MC45LTcuNCA0Ni40LTMzLjdsLTI1LTE0NS41IDEwNS43LTEwM2MxOS0xOC41IDguNS01MC44LTE3LjctNTQuNkwzODIgMTUwLjIgMzE2LjcgMTcuOGMtMTEuNy0yMy42LTQ1LjYtMjMuOS01Ny40IDB6XCIpO1xyXG4gICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgbGluay50aXRsZSA9ICdBZGQgdG8gZmF2b3JpdGUnO1xyXG4gICAgICAgICBsaW5rLnNldEF0dHJpYnV0ZSgnYXJpYS1sYWJlbCcsICdBZGQgdG8gZmF2b3JpdGUnKTtcclxuICAgICAgICAgbGluay5kYXRhc2V0LmZhdm9yaXRlID0gJ2FkZCc7XHJcbiAgICAgICAgIGxpbmsuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ3RpdGxlJylbMF0uaW5uZXJIVE1MID0gJ0FkZCB0byBmYXZvcml0ZSc7XHJcbiAgICAgICAgIGxpbmsuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ3BhdGgnKVswXS5zZXRBdHRyaWJ1dGUoXCJkXCIsXCJNNTI4LjEgMTcxLjVMMzgyIDE1MC4yIDMxNi43IDE3LjhjLTExLjctMjMuNi00NS42LTIzLjktNTcuNCAwTDE5NCAxNTAuMiA0Ny45IDE3MS41Yy0yNi4yIDMuOC0zNi43IDM2LjEtMTcuNyA1NC42bDEwNS43IDEwMy0yNSAxNDUuNWMtNC41IDI2LjMgMjMuMiA0NiA0Ni40IDMzLjdMMjg4IDQzOS42bDEzMC43IDY4LjdjMjMuMiAxMi4yIDUwLjktNy40IDQ2LjQtMzMuN2wtMjUtMTQ1LjUgMTA1LjctMTAzYzE5LTE4LjUgOC41LTUwLjgtMTcuNy01NC42ek0zODguNiAzMTIuM2wyMy43IDEzOC40TDI4OCAzODUuNGwtMTI0LjMgNjUuMyAyMy43LTEzOC40LTEwMC42LTk4IDEzOS0yMC4yIDYyLjItMTI2IDYyLjIgMTI2IDEzOSAyMC4yLTEwMC42IDk4elwiKTtcclxuICAgICAgIH1cclxuICAgICB9KTtcclxuICAgfSk7XHJcbiB9XHJcbiJdfQ=="}